<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="//fonts.googleapis.com/css?family=PingFang SC:300,300italic,400,400italic,700,700italic|consolas:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","Muse | Mist":320,"display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":true,"style":"default"},"back2top":{"enable":true,"sidebar":false,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":false,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="swiftä»£ç æ¨èè¿™ä¸ªç¤ºä¾‹å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨é—­åŒ…æ¥å¯¹ä¸€ä¸ªæ•°ç»„ä¸­çš„å­—ç¬¦ä¸²è¿›è¡Œæ’åºï¼š 12345678910import Foundationlet fruits &#x3D; [&quot;Apple&quot;, &quot;Banana&quot;, &quot;Orange&quot;, &quot;Mango&quot;, &quot;Pineapple&quot;]&#x2F;&#x2F; ä½¿ç”¨é—­åŒ…è¿›è¡Œæ’åºï¼ŒæŒ‰å­—æ¯é¡ºåºå‡åº">
<meta property="og:type" content="article">
<meta property="og:title" content="swiftä¸åŒé˜¶æ®µçš„ä»£ç ç¤ºä¾‹">
<meta property="og:url" content="http://example.com/2025/04/02/swift%E4%B8%8D%E5%90%8C%E9%98%B6%E6%AE%B5%E7%9A%84%E4%BB%A3%E7%A0%81%E7%A4%BA%E4%BE%8B/index.html">
<meta property="og:site_name" content="Yi&#39;s Lab">
<meta property="og:description" content="swiftä»£ç æ¨èè¿™ä¸ªç¤ºä¾‹å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨é—­åŒ…æ¥å¯¹ä¸€ä¸ªæ•°ç»„ä¸­çš„å­—ç¬¦ä¸²è¿›è¡Œæ’åºï¼š 12345678910import Foundationlet fruits &#x3D; [&quot;Apple&quot;, &quot;Banana&quot;, &quot;Orange&quot;, &quot;Mango&quot;, &quot;Pineapple&quot;]&#x2F;&#x2F; ä½¿ç”¨é—­åŒ…è¿›è¡Œæ’åºï¼ŒæŒ‰å­—æ¯é¡ºåºå‡åº">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2025-04-02T14:51:45.000Z">
<meta property="article:modified_time" content="2025-09-01T08:36:04.797Z">
<meta property="article:author" content="YiDa">
<meta property="article:tag" content="swiftç¼–ç¨‹">
<meta property="article:tag" content="ä»£ç ç¤ºä¾‹">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://example.com/2025/04/02/swift%E4%B8%8D%E5%90%8C%E9%98%B6%E6%AE%B5%E7%9A%84%E4%BB%A3%E7%A0%81%E7%A4%BA%E4%BE%8B/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>swiftä¸åŒé˜¶æ®µçš„ä»£ç ç¤ºä¾‹ | Yi's Lab</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="åˆ‡æ¢å¯¼èˆªæ ">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Yi's Lab</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">You Find Your Own Tree.</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section">é¦–é¡µ</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section">å…³äº</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section">æ ‡ç­¾</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section">åˆ†ç±»</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section">å½’æ¡£</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger">æœç´¢
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="æœç´¢..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>

  <a href="https://github.com/zhangyida-lab" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2025/04/02/swift%E4%B8%8D%E5%90%8C%E9%98%B6%E6%AE%B5%E7%9A%84%E4%BB%A3%E7%A0%81%E7%A4%BA%E4%BE%8B/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="YiDa">
      <meta itemprop="description" content="è‡ªå¤äººç”Ÿäºä¸–ï¼Œé¡»æœ‰ä¸€æŠ€ä¹‹èƒ½ï¼›æˆ‘è¾ˆæ—¢åŠ¡æ–¯ä¸šï¼Œä¾¿å½“ä¸“å¿ƒç”¨åŠŸï¼›ä»¥ååæ‰¬å››æµ·ï¼Œæ ¹æ®å³åœ¨å¹´è½»ã€‚">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Yi's Lab">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          swiftä¸åŒé˜¶æ®µçš„ä»£ç ç¤ºä¾‹
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2025-04-02 23:51:45" itemprop="dateCreated datePublished" datetime="2025-04-02T23:51:45+09:00">2025-04-02</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2025-09-01 17:36:04" itemprop="dateModified" datetime="2025-09-01T17:36:04+09:00">2025-09-01</time>
              </span>

          
            <span class="post-meta-item" title="é˜…è¯»æ¬¡æ•°" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">é˜…è¯»æ¬¡æ•°ï¼š</span>
              <span id="busuanzi_value_page_pv"></span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h1 id="swiftä»£ç æ¨è"><a href="#swiftä»£ç æ¨è" class="headerlink" title="swiftä»£ç æ¨è"></a>swiftä»£ç æ¨è</h1><p>è¿™ä¸ªç¤ºä¾‹å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨é—­åŒ…æ¥å¯¹ä¸€ä¸ªæ•°ç»„ä¸­çš„å­—ç¬¦ä¸²è¿›è¡Œæ’åºï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Foundation</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> fruits <span class="operator">=</span> [<span class="string">&quot;Apple&quot;</span>, <span class="string">&quot;Banana&quot;</span>, <span class="string">&quot;Orange&quot;</span>, <span class="string">&quot;Mango&quot;</span>, <span class="string">&quot;Pineapple&quot;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨é—­åŒ…è¿›è¡Œæ’åºï¼ŒæŒ‰å­—æ¯é¡ºåºå‡åºæ’åˆ—</span></span><br><span class="line"><span class="keyword">let</span> sortedFruits <span class="operator">=</span> fruits.sorted &#123; (fruit1, fruit2) -&gt; <span class="type">Bool</span> <span class="keyword">in</span></span><br><span class="line">    <span class="keyword">return</span> fruit1 <span class="operator">&amp;</span>lt; fruit2</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Sorted fruits: <span class="subst">\(sortedFruits)</span>&quot;</span>)</span><br></pre></td></tr></table></figure>
<span id="more"></span>

<p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨äº† <code>sorted</code> å‡½æ•°ï¼Œå®ƒæ¥æ”¶ä¸€ä¸ªé—­åŒ…æ¥å®šä¹‰æ’åºçš„è§„åˆ™ã€‚é—­åŒ…æ¥æ”¶ä¸¤ä¸ªå‚æ•° <code>fruit1</code> å’Œ <code>fruit2</code>ï¼Œå¹¶è¿”å›ä¸€ä¸ª <code>Bool</code> å€¼æ¥æŒ‡ç¤ºå®ƒä»¬çš„é¡ºåºã€‚<code>fruit1 &amp;lt; fruit2</code> ä¼šè¿”å› <code>true</code>ï¼Œæ„å‘³ç€ <code>fruit1</code> åº”è¯¥æ’åœ¨ <code>fruit2</code> å‰é¢ã€‚</p>
<p>è¿™ç§å†™æ³•éå¸¸çµæ´»ï¼Œé—­åŒ…å¯ä»¥æ ¹æ®éœ€è¦ä¿®æ”¹æ’åºçš„é€»è¾‘ã€‚æ¯”å¦‚ä½ å¯ä»¥æ”¹ä¸ºæŒ‰å­—ç¬¦ä¸²çš„é•¿åº¦ã€é€†åºæ’åºç­‰ã€‚</p>
<p>å¦ä¸€ä¸ª Swift ä»£ç ç¤ºä¾‹ï¼Œå±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨ <code>map</code>ã€<code>filter</code> å’Œ <code>reduce</code> å‡½æ•°æ¥å¤„ç†æ•°ç»„ï¼š</p>
<h3 id="ç¤ºä¾‹-1-ä½¿ç”¨-map-è¿›è¡Œè½¬æ¢"><a href="#ç¤ºä¾‹-1-ä½¿ç”¨-map-è¿›è¡Œè½¬æ¢" class="headerlink" title="ç¤ºä¾‹ 1: ä½¿ç”¨ map è¿›è¡Œè½¬æ¢"></a>ç¤ºä¾‹ 1: ä½¿ç”¨ map è¿›è¡Œè½¬æ¢</h3><p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªæ•´æ•°æ•°ç»„ï¼Œå¹¶æƒ³å°†æ¯ä¸ªæ•°å€¼ä¹˜ä»¥ 2ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> numbers <span class="operator">=</span> [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨ map å‡½æ•°å°†æ¯ä¸ªæ•°å­—ä¹˜ä»¥ 2</span></span><br><span class="line"><span class="keyword">let</span> doubledNumbers <span class="operator">=</span> numbers.map &#123; <span class="variable">$0</span> <span class="operator">*</span> <span class="number">2</span> &#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Doubled numbers: <span class="subst">\(doubledNumbers)</span>&quot;</span>)</span><br></pre></td></tr></table></figure>


<h3 id="ç¤ºä¾‹-2-ä½¿ç”¨-filter-è¿›è¡Œç­›é€‰"><a href="#ç¤ºä¾‹-2-ä½¿ç”¨-filter-è¿›è¡Œç­›é€‰" class="headerlink" title="ç¤ºä¾‹ 2: ä½¿ç”¨ filter è¿›è¡Œç­›é€‰"></a>ç¤ºä¾‹ 2: ä½¿ç”¨ filter è¿›è¡Œç­›é€‰</h3><p>å‡è®¾æˆ‘ä»¬æƒ³è¦ç­›é€‰å‡ºæ‰€æœ‰å¶æ•°ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> numbers <span class="operator">=</span> [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨ filter å‡½æ•°ç­›é€‰å‡ºæ‰€æœ‰å¶æ•°</span></span><br><span class="line"><span class="keyword">let</span> evenNumbers <span class="operator">=</span> numbers.filter &#123; <span class="variable">$0</span> <span class="operator">%</span> <span class="number">2</span> <span class="operator">==</span> <span class="number">0</span> &#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Even numbers: <span class="subst">\(evenNumbers)</span>&quot;</span>)</span><br></pre></td></tr></table></figure>


<h3 id="ç¤ºä¾‹-3-ä½¿ç”¨-reduce-è¿›è¡Œæ±‚å’Œ"><a href="#ç¤ºä¾‹-3-ä½¿ç”¨-reduce-è¿›è¡Œæ±‚å’Œ" class="headerlink" title="ç¤ºä¾‹ 3: ä½¿ç”¨ reduce è¿›è¡Œæ±‚å’Œ"></a>ç¤ºä¾‹ 3: ä½¿ç”¨ reduce è¿›è¡Œæ±‚å’Œ</h3><p>å‡è®¾æˆ‘ä»¬æƒ³è¦è®¡ç®—æ•°ç»„æ‰€æœ‰å…ƒç´ çš„å’Œï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> numbers <span class="operator">=</span> [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨ reduce å‡½æ•°æ±‚å’Œ</span></span><br><span class="line"><span class="keyword">let</span> sum <span class="operator">=</span> numbers.reduce(<span class="number">0</span>) &#123; <span class="variable">$0</span> <span class="operator">+</span> <span class="variable">$1</span> &#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Sum of numbers: <span class="subst">\(sum)</span>&quot;</span>)</span><br></pre></td></tr></table></figure>


<h3 id="æ€»ç»“ï¼š"><a href="#æ€»ç»“ï¼š" class="headerlink" title="æ€»ç»“ï¼š"></a>æ€»ç»“ï¼š</h3><ul>
<li><code>map</code> ç”¨äºå°†æ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ è½¬æ¢ä¸ºæ–°çš„å€¼ã€‚</li>
<li><code>filter</code> ç”¨äºä»æ•°ç»„ä¸­ç­›é€‰å‡ºç¬¦åˆæ¡ä»¶çš„å…ƒç´ ã€‚</li>
<li><code>reduce</code> ç”¨äºå°†æ•°ç»„ä¸­çš„å…ƒç´ â€œå½’çº¦â€æˆä¸€ä¸ªå•ä¸€çš„å€¼ï¼Œæ¯”å¦‚æ±‚å’Œæˆ–ç´¯ç§¯ã€‚</li>
</ul>
<p>è¿™äº›å‡½æ•°éå¸¸é€‚åˆè¿›è¡Œé“¾å¼æ“ä½œï¼Œå¯ä»¥è®©ä»£ç æ›´åŠ ç®€æ´å’Œæ˜“è¯»ã€‚ä½ å¯ä»¥ç»„åˆä½¿ç”¨å®ƒä»¬ï¼Œè¿›è¡Œæ›´å¤æ‚çš„æ“ä½œï¼</p>
<h1 id="ä¸€äº›æ›´é«˜çº§çš„-Swift-ä»£ç ç¤ºä¾‹ï¼Œæ¶‰åŠ-æ³›å‹ã€é«˜é˜¶å‡½æ•°ã€ç»„åˆå¼å‡½æ•°å¼ç¼–ç¨‹ã€å±æ€§åŒ…è£…å™¨ã€Async-x2F-Await-å¹¶å‘-ç­‰å†…å®¹ã€‚"><a href="#ä¸€äº›æ›´é«˜çº§çš„-Swift-ä»£ç ç¤ºä¾‹ï¼Œæ¶‰åŠ-æ³›å‹ã€é«˜é˜¶å‡½æ•°ã€ç»„åˆå¼å‡½æ•°å¼ç¼–ç¨‹ã€å±æ€§åŒ…è£…å™¨ã€Async-x2F-Await-å¹¶å‘-ç­‰å†…å®¹ã€‚" class="headerlink" title="ä¸€äº›æ›´é«˜çº§çš„ Swift ä»£ç ç¤ºä¾‹ï¼Œæ¶‰åŠ æ³›å‹ã€é«˜é˜¶å‡½æ•°ã€ç»„åˆå¼å‡½æ•°å¼ç¼–ç¨‹ã€å±æ€§åŒ…è£…å™¨ã€Async&#x2F;Await å¹¶å‘ ç­‰å†…å®¹ã€‚"></a>ä¸€äº›æ›´é«˜çº§çš„ Swift ä»£ç ç¤ºä¾‹ï¼Œæ¶‰åŠ <strong>æ³›å‹ã€é«˜é˜¶å‡½æ•°ã€ç»„åˆå¼å‡½æ•°å¼ç¼–ç¨‹ã€å±æ€§åŒ…è£…å™¨ã€Async&#x2F;Await å¹¶å‘</strong> ç­‰å†…å®¹ã€‚</h1><h3 id="ç¤ºä¾‹-1-æ³›å‹-å…³è”ç±»å‹-åè®®"><a href="#ç¤ºä¾‹-1-æ³›å‹-å…³è”ç±»å‹-åè®®" class="headerlink" title="ç¤ºä¾‹ 1: æ³›å‹ + å…³è”ç±»å‹ + åè®®"></a><strong>ç¤ºä¾‹ 1: æ³›å‹ + å…³è”ç±»å‹ + åè®®</strong></h3><p>ä½¿ç”¨æ³›å‹å’Œåè®®æ‰©å±• Swift ç±»å‹çš„é€‚ç”¨æ€§ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">protocol</span> <span class="title class_">Stackable</span> &#123;</span><br><span class="line">    <span class="keyword">associatedtype</span> <span class="type">Element</span></span><br><span class="line">    <span class="keyword">mutating</span> <span class="keyword">func</span> <span class="title function_">push</span>(<span class="keyword">_</span> <span class="params">element</span>: <span class="type">Element</span>)</span><br><span class="line">    <span class="keyword">mutating</span> <span class="keyword">func</span> <span class="title function_">pop</span>() -&gt; <span class="type">Element</span>?</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Stack</span>: <span class="title class_">Stackable</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">var</span> elements: [<span class="type">T</span>] <span class="operator">=</span> []</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">mutating</span> <span class="keyword">func</span> <span class="title function_">push</span>(<span class="keyword">_</span> <span class="params">element</span>: <span class="type">T</span>) &#123;</span><br><span class="line">        elements.append(element)</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">mutating</span> <span class="keyword">func</span> <span class="title function_">pop</span>() -&gt; <span class="type">T</span>? &#123;</span><br><span class="line">        <span class="keyword">return</span> elements.popLast()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> intStack <span class="operator">=</span> <span class="type">Stack</span>()</span><br><span class="line">intStack.push(<span class="number">10</span>)</span><br><span class="line">intStack.push(<span class="number">20</span>)</span><br><span class="line"><span class="built_in">print</span>(intStack.pop() <span class="operator">??</span> <span class="string">&quot;Empty&quot;</span>) <span class="comment">// è¾“å‡º 20</span></span><br></pre></td></tr></table></figure>


<p><strong>çŸ¥è¯†ç‚¹ï¼š</strong></p>
<ul>
<li><code>associatedtype</code> å…è®¸åè®®å®šä¹‰ä¸€ä¸ªæ³›å‹ç±»å‹ã€‚</li>
<li><code>mutating</code> ç¡®ä¿ <code>struct</code> å¯ä»¥ä¿®æ”¹å…¶è‡ªèº«çš„å±æ€§ã€‚</li>
</ul>
<h3 id="ç¤ºä¾‹-2-é«˜é˜¶å‡½æ•°-amp-ç»„åˆå¼ç¼–ç¨‹"><a href="#ç¤ºä¾‹-2-é«˜é˜¶å‡½æ•°-amp-ç»„åˆå¼ç¼–ç¨‹" class="headerlink" title="ç¤ºä¾‹ 2: é«˜é˜¶å‡½æ•° &amp; ç»„åˆå¼ç¼–ç¨‹"></a><strong>ç¤ºä¾‹ 2: é«˜é˜¶å‡½æ•° &amp; ç»„åˆå¼ç¼–ç¨‹</strong></h3><p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªç”¨æˆ·åˆ—è¡¨ï¼Œéœ€è¦ç­›é€‰å‡ºå¹´é¾„å¤§äº 18 å²çš„ç”¨æˆ·ï¼Œå¹¶æå–ä»–ä»¬çš„å§“åï¼Œç„¶åè½¬æ¢ä¸ºå¤§å†™ã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">User</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> name: <span class="type">String</span></span><br><span class="line">    <span class="keyword">let</span> age: <span class="type">Int</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> users <span class="operator">=</span> [</span><br><span class="line">    <span class="type">User</span>(name: <span class="string">&quot;Alice&quot;</span>, age: <span class="number">24</span>),</span><br><span class="line">    <span class="type">User</span>(name: <span class="string">&quot;Bob&quot;</span>, age: <span class="number">17</span>),</span><br><span class="line">    <span class="type">User</span>(name: <span class="string">&quot;Charlie&quot;</span>, age: <span class="number">30</span>)</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> adultNames <span class="operator">=</span> users</span><br><span class="line">    .filter &#123; <span class="variable">$0</span>.age <span class="operator">&amp;</span>gt;<span class="operator">=</span> <span class="number">18</span> &#125;  <span class="comment">// è¿‡æ»¤å‡ºå¹´é¾„ &amp;gt;= 18 çš„ç”¨æˆ·</span></span><br><span class="line">    .map &#123; <span class="variable">$0</span>.name.uppercased() &#125; <span class="comment">// æå–åå­—å¹¶è½¬æ¢ä¸ºå¤§å†™</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(adultNames) <span class="comment">// è¾“å‡º [&quot;ALICE&quot;, &quot;CHARLIE&quot;]</span></span><br></pre></td></tr></table></figure>


<p><strong>çŸ¥è¯†ç‚¹ï¼š</strong></p>
<ul>
<li><code>filter</code> è¿›è¡Œç­›é€‰ã€‚</li>
<li><code>map</code> è¿›è¡Œæ•°æ®è½¬æ¢ã€‚</li>
<li>ç»„åˆå¼å‡½æ•°å¼ç¼–ç¨‹ï¼Œè®©ä»£ç æ›´ç®€æ´ã€‚</li>
</ul>
<h3 id="ç¤ºä¾‹-3-è‡ªå®šä¹‰å±æ€§åŒ…è£…å™¨"><a href="#ç¤ºä¾‹-3-è‡ªå®šä¹‰å±æ€§åŒ…è£…å™¨" class="headerlink" title="ç¤ºä¾‹ 3: è‡ªå®šä¹‰å±æ€§åŒ…è£…å™¨"></a><strong>ç¤ºä¾‹ 3: è‡ªå®šä¹‰å±æ€§åŒ…è£…å™¨</strong></h3><p>Swift çš„ <code>@propertyWrapper</code> å…è®¸ä½ åˆ›å»ºè‡ªå®šä¹‰çš„å±æ€§è¡Œä¸ºã€‚è¿™é‡Œå®ç°ä¸€ä¸ª <code>Clamped</code>ï¼Œç”¨äºç¡®ä¿å˜é‡å€¼ä¿æŒåœ¨æŒ‡å®šèŒƒå›´å†…ã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">@propertyWrapper</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Clamped</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">var</span> value: <span class="type">Value</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">let</span> range: <span class="type">ClosedRange</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">init</span>(<span class="params">wrappedValue</span>: <span class="type">Value</span>, <span class="keyword">_</span> <span class="params">range</span>: <span class="type">ClosedRange</span>) &#123;</span><br><span class="line">        <span class="keyword">self</span>.range <span class="operator">=</span> range</span><br><span class="line">        <span class="keyword">self</span>.value <span class="operator">=</span> <span class="built_in">min</span>(<span class="built_in">max</span>(wrappedValue, range.lowerBound), range.upperBound)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> wrappedValue: <span class="type">Value</span> &#123;</span><br><span class="line">        <span class="keyword">get</span> &#123; value &#125;</span><br><span class="line">        <span class="keyword">set</span> &#123; value <span class="operator">=</span> <span class="built_in">min</span>(<span class="built_in">max</span>(newValue, range.lowerBound), range.upperBound) &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Player</span> &#123;</span><br><span class="line">    <span class="meta">@Clamped</span>(<span class="number">0</span><span class="operator">...</span><span class="number">100</span>) <span class="keyword">var</span> health: <span class="type">Int</span> <span class="operator">=</span> <span class="number">50</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> player <span class="operator">=</span> <span class="type">Player</span>()</span><br><span class="line">player.health <span class="operator">=</span> <span class="number">120</span></span><br><span class="line"><span class="built_in">print</span>(player.health) <span class="comment">// è¾“å‡º 100</span></span><br></pre></td></tr></table></figure>


<p><strong>çŸ¥è¯†ç‚¹ï¼š</strong></p>
<ul>
<li><code>@propertyWrapper</code> è®©ä½ å°è£…é€šç”¨çš„å±æ€§è¡Œä¸ºï¼Œå¦‚èŒƒå›´çº¦æŸã€‚</li>
</ul>
<h3 id="ç¤ºä¾‹-4-Async-x2F-Await-å¹¶å‘"><a href="#ç¤ºä¾‹-4-Async-x2F-Await-å¹¶å‘" class="headerlink" title="ç¤ºä¾‹ 4: Async&#x2F;Await å¹¶å‘"></a><strong>ç¤ºä¾‹ 4: Async&#x2F;Await å¹¶å‘</strong></h3><p>Swift çš„ <code>async/await</code> ä½¿å¼‚æ­¥ä»£ç æ›´æ˜“è¯»ã€‚ä»¥ä¸‹ç¤ºä¾‹æ¨¡æ‹Ÿä¸€ä¸ªç½‘ç»œè¯·æ±‚ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Foundation</span><br><span class="line"></span><br><span class="line"><span class="keyword">func</span> <span class="title function_">fetchUserData</span>() <span class="keyword">async</span> <span class="keyword">throws</span> -&gt; <span class="type">String</span> &#123;</span><br><span class="line">    <span class="keyword">try</span> <span class="keyword">await</span> <span class="type">Task</span>.sleep(nanoseconds: <span class="number">2_000_000_000</span>) <span class="comment">// æ¨¡æ‹Ÿ 2 ç§’ç½‘ç»œå»¶è¿Ÿ</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;User Data Loaded&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">Task</span> &#123;</span><br><span class="line">    <span class="keyword">do</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> data <span class="operator">=</span> <span class="keyword">try</span> <span class="keyword">await</span> fetchUserData()</span><br><span class="line">        <span class="built_in">print</span>(data) <span class="comment">// è¾“å‡º &quot;User Data Loaded&quot;</span></span><br><span class="line">    &#125; <span class="keyword">catch</span> &#123;</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Failed to fetch data: <span class="subst">\(error)</span>&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<p><strong>çŸ¥è¯†ç‚¹ï¼š</strong></p>
<ul>
<li><code>async/await</code> è®©å¼‚æ­¥ä»£ç åƒåŒæ­¥ä»£ç ä¸€æ ·æ˜“è¯»ã€‚</li>
<li><code>Task.sleep(nanoseconds:)</code> æ¨¡æ‹Ÿå¼‚æ­¥æ“ä½œã€‚</li>
</ul>
<p>è¿™äº›ç¤ºä¾‹æ¶‰åŠ Swift è¿›é˜¶æ¦‚å¿µï¼Œå¦‚æ³›å‹ã€ç»„åˆå¼ç¼–ç¨‹ã€å±æ€§åŒ…è£…å™¨å’Œå¹¶å‘ã€‚ä½ å¯ä»¥è¯•ç€æ”¹é€ å’Œä¼˜åŒ–å®ƒä»¬ï¼ŒæŒ‘æˆ˜æ›´å¤æ‚çš„å®ç°ï¼ğŸš€</p>
<h1 id="æ¶‰åŠ-é«˜çº§æ³›å‹ã€Combine-å“åº”å¼ç¼–ç¨‹ã€Actor-å¹¶å‘å®‰å…¨ã€Swift-åå°„ï¼ˆMirrorï¼‰ï¼Œä»¥åŠ-DSLï¼ˆé¢†åŸŸç‰¹å®šè¯­è¨€ï¼‰è®¾è®¡ã€‚"><a href="#æ¶‰åŠ-é«˜çº§æ³›å‹ã€Combine-å“åº”å¼ç¼–ç¨‹ã€Actor-å¹¶å‘å®‰å…¨ã€Swift-åå°„ï¼ˆMirrorï¼‰ï¼Œä»¥åŠ-DSLï¼ˆé¢†åŸŸç‰¹å®šè¯­è¨€ï¼‰è®¾è®¡ã€‚" class="headerlink" title="æ¶‰åŠ é«˜çº§æ³›å‹ã€Combine å“åº”å¼ç¼–ç¨‹ã€Actor å¹¶å‘å®‰å…¨ã€Swift åå°„ï¼ˆMirrorï¼‰ï¼Œä»¥åŠ DSLï¼ˆé¢†åŸŸç‰¹å®šè¯­è¨€ï¼‰è®¾è®¡ã€‚"></a>æ¶‰åŠ <strong>é«˜çº§æ³›å‹ã€Combine å“åº”å¼ç¼–ç¨‹ã€Actor å¹¶å‘å®‰å…¨ã€Swift åå°„ï¼ˆMirrorï¼‰</strong>ï¼Œä»¥åŠ <strong>DSLï¼ˆé¢†åŸŸç‰¹å®šè¯­è¨€ï¼‰è®¾è®¡</strong>ã€‚</h1><h2 id="ç¤ºä¾‹-1-ç»“åˆæ³›å‹ã€åè®®å’Œä¾èµ–æ³¨å…¥"><a href="#ç¤ºä¾‹-1-ç»“åˆæ³›å‹ã€åè®®å’Œä¾èµ–æ³¨å…¥" class="headerlink" title="ç¤ºä¾‹ 1: ç»“åˆæ³›å‹ã€åè®®å’Œä¾èµ–æ³¨å…¥"></a><strong>ç¤ºä¾‹ 1: ç»“åˆæ³›å‹ã€åè®®å’Œä¾èµ–æ³¨å…¥</strong></h2><p>æˆ‘ä»¬æ„å»ºä¸€ä¸ª <strong>æ³›å‹å­˜å‚¨ç³»ç»Ÿ</strong>ï¼Œå¯ä»¥å­˜å‚¨ä¸åŒç±»å‹çš„æ•°æ®ï¼Œå¹¶æ”¯æŒè§£è€¦çš„ä¾èµ–æ³¨å…¥ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">protocol</span> <span class="title class_">Storage</span> &#123;</span><br><span class="line">    <span class="keyword">associatedtype</span> <span class="type">Item</span></span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">save</span>(<span class="keyword">_</span> <span class="params">item</span>: <span class="type">Item</span>)</span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">load</span>() -&gt; <span class="type">Item</span>?</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">UserDefaultsStorage</span>: <span class="title class_">Storage</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">let</span> key: <span class="type">String</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">init</span>(<span class="params">key</span>: <span class="type">String</span>) &#123;</span><br><span class="line">        <span class="keyword">self</span>.key <span class="operator">=</span> key</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">save</span>(<span class="keyword">_</span> <span class="params">item</span>: <span class="type">T</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">let</span> data <span class="operator">=</span> <span class="keyword">try?</span> <span class="type">JSONEncoder</span>().encode(item) &#123;</span><br><span class="line">            <span class="type">UserDefaults</span>.standard.set(data, forKey: key)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">load</span>() -&gt; <span class="type">T</span>? &#123;</span><br><span class="line">        <span class="keyword">guard</span> <span class="keyword">let</span> data <span class="operator">=</span> <span class="type">UserDefaults</span>.standard.data(forKey: key),</span><br><span class="line">              <span class="keyword">let</span> item <span class="operator">=</span> <span class="keyword">try?</span> <span class="type">JSONDecoder</span>().decode(<span class="type">T</span>.<span class="keyword">self</span>, from: data) <span class="keyword">else</span> &#123; <span class="keyword">return</span> <span class="literal">nil</span> &#125;</span><br><span class="line">        <span class="keyword">return</span> item</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨ç¤ºä¾‹</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">User</span>: <span class="title class_">Codable</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> name: <span class="type">String</span></span><br><span class="line">    <span class="keyword">let</span> age: <span class="type">Int</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> userStorage <span class="operator">=</span> <span class="type">UserDefaultsStorage</span>(key: <span class="string">&quot;savedUser&quot;</span>)</span><br><span class="line">userStorage.save(<span class="type">User</span>(name: <span class="string">&quot;Alice&quot;</span>, age: <span class="number">25</span>))</span><br><span class="line"><span class="built_in">print</span>(userStorage.load() <span class="operator">??</span> <span class="string">&quot;No user found&quot;</span>)</span><br></pre></td></tr></table></figure>


<h3 id="å…³é”®ç‚¹"><a href="#å…³é”®ç‚¹" class="headerlink" title="å…³é”®ç‚¹"></a><strong>å…³é”®ç‚¹</strong></h3><p>âœ… ä½¿ç”¨ <code>associatedtype</code> è®© <code>Storage</code> æ”¯æŒæ³›å‹å­˜å‚¨ã€‚<br>âœ… <code>Codable</code> è®©å­˜å‚¨æ•°æ®æ›´åŠ çµæ´»ã€‚<br>âœ… <code>UserDefaultsStorage&amp;lt;T&amp;gt;</code> å¯ä»¥å­˜å‚¨ <strong>ä»»æ„ Codable ç±»å‹</strong>ï¼Œå¢å¼ºäº†ä»£ç çš„å¯å¤ç”¨æ€§ã€‚</p>
<h2 id="ç¤ºä¾‹-2-ä½¿ç”¨-Combine-è¿›è¡Œå“åº”å¼æ•°æ®æµ"><a href="#ç¤ºä¾‹-2-ä½¿ç”¨-Combine-è¿›è¡Œå“åº”å¼æ•°æ®æµ" class="headerlink" title="ç¤ºä¾‹ 2: ä½¿ç”¨ Combine è¿›è¡Œå“åº”å¼æ•°æ®æµ"></a><strong>ç¤ºä¾‹ 2: ä½¿ç”¨ Combine è¿›è¡Œå“åº”å¼æ•°æ®æµ</strong></h2><p>æˆ‘ä»¬åˆ›å»ºä¸€ä¸ª <strong>å“åº”å¼è®¡æ—¶å™¨</strong>ï¼Œå®ƒä¼šæ¯ç§’å‘é€å½“å‰æ—¶é—´ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Combine</span><br><span class="line"><span class="keyword">import</span> Foundation</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">TimerPublisher</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">var</span> cancellable: <span class="type">AnyCancellable</span>?</span><br><span class="line"></span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">start</span>() &#123;</span><br><span class="line">        cancellable <span class="operator">=</span> <span class="type">Timer</span>.publish(every: <span class="number">1</span>, on: .main, in: .common)</span><br><span class="line">            .autoconnect()</span><br><span class="line">            .sink &#123; time <span class="keyword">in</span></span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;Current Time: <span class="subst">\(time)</span>&quot;</span>)</span><br><span class="line">            &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">stop</span>() &#123;</span><br><span class="line">        cancellable<span class="operator">?</span>.cancel()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> timer <span class="operator">=</span> <span class="type">TimerPublisher</span>()</span><br><span class="line">timer.start()</span><br><span class="line"></span><br><span class="line"><span class="comment">// è®©ç¨‹åºè¿è¡Œ 5 ç§’é’Ÿ</span></span><br><span class="line"><span class="type">DispatchQueue</span>.main.asyncAfter(deadline: .now() <span class="operator">+</span> <span class="number">5</span>) &#123;</span><br><span class="line">    timer.stop()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h3 id="å…³é”®ç‚¹-1"><a href="#å…³é”®ç‚¹-1" class="headerlink" title="å…³é”®ç‚¹"></a><strong>å…³é”®ç‚¹</strong></h3><p>âœ… <code>Timer.publish</code> åˆ›å»ºå®šæ—¶å™¨äº‹ä»¶æµã€‚<br>âœ… <code>autoconnect()</code> è®©è®¢é˜…è€…è‡ªåŠ¨å¼€å§‹æ¥æ”¶æ•°æ®ã€‚<br>âœ… <code>sink &#123;&#125;</code> å¤„ç†æ•°æ®ï¼Œæ¯ç§’æ‰“å°ä¸€æ¬¡æ—¶é—´ã€‚<br>âœ… <code>cancellable?.cancel()</code> é‡Šæ”¾èµ„æºï¼Œé˜²æ­¢å†…å­˜æ³„æ¼ã€‚</p>
<h2 id="ç¤ºä¾‹-3-ä½¿ç”¨-actor-ä¿æŠ¤å…±äº«èµ„æº"><a href="#ç¤ºä¾‹-3-ä½¿ç”¨-actor-ä¿æŠ¤å…±äº«èµ„æº" class="headerlink" title="ç¤ºä¾‹ 3: ä½¿ç”¨ actor ä¿æŠ¤å…±äº«èµ„æº"></a><strong>ç¤ºä¾‹ 3: ä½¿ç”¨ actor ä¿æŠ¤å…±äº«èµ„æº</strong></h2><p>åœ¨ Swift çš„å¤šçº¿ç¨‹ç¯å¢ƒä¸­ï¼Œæˆ‘ä»¬ç”¨ <code>actor</code> ç¡®ä¿çº¿ç¨‹å®‰å…¨ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">actor</span> <span class="title class_">SafeCounter</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">var</span> value <span class="operator">=</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">increment</span>() &#123;</span><br><span class="line">        value <span class="operator">+=</span> <span class="number">1</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">getValue</span>() -&gt; <span class="type">Int</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> value</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> counter <span class="operator">=</span> <span class="type">SafeCounter</span>()</span><br><span class="line"></span><br><span class="line"><span class="type">Task</span> &#123;</span><br><span class="line">    <span class="keyword">await</span> counter.increment()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Counter: <span class="subst">\(<span class="keyword">await</span> counter.getValue())</span>&quot;</span>) <span class="comment">// 1</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h3 id="å…³é”®ç‚¹-2"><a href="#å…³é”®ç‚¹-2" class="headerlink" title="å…³é”®ç‚¹"></a><strong>å…³é”®ç‚¹</strong></h3><p>âœ… <code>actor</code> ä½¿ <code>SafeCounter</code> çº¿ç¨‹å®‰å…¨ã€‚<br>âœ… <code>await</code> ç¡®ä¿å¹¶å‘è°ƒç”¨æ—¶çš„æ­£ç¡®æ€§ã€‚<br>âœ… è§£å†³ <strong>æ•°æ®ç«äº‰</strong> é—®é¢˜ã€‚</p>
<h2 id="ç¤ºä¾‹-4-ä½¿ç”¨-Mirror-è¿›è¡Œ-Swift-åå°„"><a href="#ç¤ºä¾‹-4-ä½¿ç”¨-Mirror-è¿›è¡Œ-Swift-åå°„" class="headerlink" title="ç¤ºä¾‹ 4: ä½¿ç”¨ Mirror è¿›è¡Œ Swift åå°„"></a><strong>ç¤ºä¾‹ 4: ä½¿ç”¨ Mirror è¿›è¡Œ Swift åå°„</strong></h2><p>Swift çš„ <code>Mirror</code> å¯ä»¥åœ¨ <strong>è¿è¡Œæ—¶</strong> è·å–å¯¹è±¡çš„å±æ€§å’Œæ–¹æ³•ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">Person</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> name: <span class="type">String</span></span><br><span class="line">    <span class="keyword">let</span> age: <span class="type">Int</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">func</span> <span class="title function_">inspect</span>(<span class="keyword">_</span> <span class="params">object</span>: <span class="keyword">Any</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> mirror <span class="operator">=</span> <span class="type">Mirror</span>(reflecting: object)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Type: <span class="subst">\(mirror.subjectType)</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">for</span> (label, value) <span class="keyword">in</span> mirror.children &#123;</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;<span class="subst">\(label <span class="operator">??</span> <span class="string">&quot;unknown&quot;</span>)</span>: <span class="subst">\(value)</span>&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> alice <span class="operator">=</span> <span class="type">Person</span>(name: <span class="string">&quot;Alice&quot;</span>, age: <span class="number">25</span>)</span><br><span class="line">inspect(alice)</span><br></pre></td></tr></table></figure>


<p><strong>è¾“å‡º</strong></p>
<figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">Type: Person</span></span><br><span class="line"><span class="section">name: Alice</span></span><br><span class="line"><span class="section">age: 25</span></span><br></pre></td></tr></table></figure>


<h3 id="å…³é”®ç‚¹-3"><a href="#å…³é”®ç‚¹-3" class="headerlink" title="å…³é”®ç‚¹"></a><strong>å…³é”®ç‚¹</strong></h3><p>âœ… <code>Mirror(reflecting:)</code> è·å–å¯¹è±¡ä¿¡æ¯ã€‚<br>âœ… <code>mirror.children</code> éå†å¯¹è±¡çš„å±æ€§å’Œå€¼ã€‚<br>âœ… é€‚ç”¨äº <strong>è°ƒè¯•ã€åºåˆ—åŒ–ã€åŠ¨æ€ UI ç”Ÿæˆ</strong> ç­‰ã€‚</p>
<h2 id="ç¤ºä¾‹-5-è®¾è®¡-DSLï¼ˆé¢†åŸŸç‰¹å®šè¯­è¨€ï¼‰"><a href="#ç¤ºä¾‹-5-è®¾è®¡-DSLï¼ˆé¢†åŸŸç‰¹å®šè¯­è¨€ï¼‰" class="headerlink" title="ç¤ºä¾‹ 5: è®¾è®¡ DSLï¼ˆé¢†åŸŸç‰¹å®šè¯­è¨€ï¼‰"></a><strong>ç¤ºä¾‹ 5: è®¾è®¡ DSLï¼ˆé¢†åŸŸç‰¹å®šè¯­è¨€ï¼‰</strong></h2><p>Swift çš„ <strong>Result Builder</strong> è®©æˆ‘ä»¬å¯ä»¥åˆ›å»ºç±»ä¼¼ SwiftUI çš„ DSLï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">@resultBuilder</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">QueryBuilder</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">func</span> <span class="title function_">buildBlock</span>(<span class="keyword">_</span> <span class="params">queries</span>: <span class="type">String</span>...) -&gt; <span class="type">String</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> queries.joined(separator: <span class="string">&quot; AND &quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">func</span> <span class="title function_">buildQuery</span>(<span class="meta">@QueryBuilder</span> <span class="keyword">_</span> <span class="params">builder</span>: () -&gt; <span class="type">String</span>) -&gt; <span class="type">String</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;SELECT * FROM users WHERE <span class="subst">\(builder())</span>&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨ DSL</span></span><br><span class="line"><span class="keyword">let</span> query <span class="operator">=</span> buildQuery &#123;</span><br><span class="line">    <span class="string">&quot;age &amp;gt; 18&quot;</span></span><br><span class="line">    <span class="string">&quot;name LIKE &#x27;A%&#x27;&quot;</span></span><br><span class="line">    <span class="string">&quot;city = &#x27;Shanghai&#x27;&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(query)</span><br></pre></td></tr></table></figure>


<p><strong>è¾“å‡º</strong></p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> users <span class="keyword">WHERE</span> age &amp;gt; <span class="number">18</span> <span class="keyword">AND</span> <span class="type">name</span> <span class="keyword">LIKE</span> <span class="string">&#x27;A%&#x27;</span> <span class="keyword">AND</span> city = <span class="string">&#x27;Shanghai&#x27;</span></span><br></pre></td></tr></table></figure>


<h3 id="å…³é”®ç‚¹-4"><a href="#å…³é”®ç‚¹-4" class="headerlink" title="å…³é”®ç‚¹"></a><strong>å…³é”®ç‚¹</strong></h3><p>âœ… <code>@resultBuilder</code> è®©ä»£ç æ›´ç¬¦åˆ <strong>DSL è¯­æ³•</strong>ã€‚<br>âœ… <code>buildBlock(_ queries: String...)</code> ç»„åˆå¤šä¸ªæŸ¥è¯¢æ¡ä»¶ã€‚<br>âœ… è¿™ç§å†™æ³•åœ¨ <strong>SQL æŸ¥è¯¢ã€JSON ç”Ÿæˆã€æ„å»º UI</strong> æ–¹é¢ç‰¹åˆ«æœ‰ç”¨ã€‚</p>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a><strong>æ€»ç»“</strong></h2><p>ä»Šå¤©çš„ç¤ºä¾‹æ›´åŠ é«˜çº§ï¼Œæ¶‰åŠï¼š<br>1ï¸âƒ£ æ³›å‹ä¸åè®®ï¼šåˆ›å»º <strong>ç±»å‹å®‰å…¨çš„å­˜å‚¨</strong>ã€‚<br>2ï¸âƒ£ Combine å“åº”å¼ç¼–ç¨‹ï¼š<strong>è®¢é˜…å¹¶å¤„ç†æ•°æ®æµ</strong>ã€‚<br>3ï¸âƒ£ <code>actor</code> çº¿ç¨‹å®‰å…¨ï¼š<strong>å¹¶å‘ç¯å¢ƒä¸‹çš„æ•°æ®å®‰å…¨ä¿æŠ¤</strong>ã€‚<br>4ï¸âƒ£ Swift åå°„ï¼š<strong>åœ¨è¿è¡Œæ—¶åŠ¨æ€è·å–å¯¹è±¡ä¿¡æ¯</strong>ã€‚<br>5ï¸âƒ£ Swift DSLï¼š<strong>æ„å»ºç®€æ´çš„æŸ¥è¯¢è¯­æ³•</strong>ã€‚</p>
<p>è¿™äº›ç¤ºä¾‹éƒ½å¯ä»¥ç›´æ¥åœ¨ Swift Playground æˆ– Xcode è¿è¡Œï¼å¦‚æœæœ‰å…´è¶£ï¼Œå¯ä»¥å°è¯•æ‹“å±•è¿™äº›åŠŸèƒ½ ğŸš€</p>
<h1 id="é‚£ä»Šå¤©æˆ‘ä»¬æ·±å…¥-å…ƒç¼–ç¨‹ã€å¹¶å‘æ§åˆ¶ã€è¿è¡Œæ—¶æ“ä½œã€è‡ªåŠ¨å¾®åˆ†ï¼ˆAutomatic-Differentiationï¼‰ã€Swift-Macroï¼ˆå®ï¼‰-è¿™äº›é«˜çº§æ¦‚å¿µã€‚ğŸš€"><a href="#é‚£ä»Šå¤©æˆ‘ä»¬æ·±å…¥-å…ƒç¼–ç¨‹ã€å¹¶å‘æ§åˆ¶ã€è¿è¡Œæ—¶æ“ä½œã€è‡ªåŠ¨å¾®åˆ†ï¼ˆAutomatic-Differentiationï¼‰ã€Swift-Macroï¼ˆå®ï¼‰-è¿™äº›é«˜çº§æ¦‚å¿µã€‚ğŸš€" class="headerlink" title="é‚£ä»Šå¤©æˆ‘ä»¬æ·±å…¥ å…ƒç¼–ç¨‹ã€å¹¶å‘æ§åˆ¶ã€è¿è¡Œæ—¶æ“ä½œã€è‡ªåŠ¨å¾®åˆ†ï¼ˆAutomatic Differentiationï¼‰ã€Swift Macroï¼ˆå®ï¼‰ è¿™äº›é«˜çº§æ¦‚å¿µã€‚ğŸš€"></a>é‚£ä»Šå¤©æˆ‘ä»¬æ·±å…¥ <strong>å…ƒç¼–ç¨‹ã€å¹¶å‘æ§åˆ¶ã€è¿è¡Œæ—¶æ“ä½œã€è‡ªåŠ¨å¾®åˆ†ï¼ˆAutomatic Differentiationï¼‰ã€Swift Macroï¼ˆå®ï¼‰</strong> è¿™äº›é«˜çº§æ¦‚å¿µã€‚ğŸš€</h1><h2 id="ç¤ºä¾‹-1-ä½¿ç”¨-Macroï¼ˆSwift-5-9-ï¼‰è¿›è¡Œä»£ç ç”Ÿæˆ"><a href="#ç¤ºä¾‹-1-ä½¿ç”¨-Macroï¼ˆSwift-5-9-ï¼‰è¿›è¡Œä»£ç ç”Ÿæˆ" class="headerlink" title="ç¤ºä¾‹ 1: ä½¿ç”¨ Macroï¼ˆSwift 5.9+ï¼‰è¿›è¡Œä»£ç ç”Ÿæˆ"></a><strong>ç¤ºä¾‹ 1: ä½¿ç”¨ Macroï¼ˆSwift 5.9+ï¼‰è¿›è¡Œä»£ç ç”Ÿæˆ</strong></h2><p>Swift 5.9 å¼•å…¥äº† <strong>å®ï¼ˆMacroï¼‰</strong>ï¼Œå…è®¸ä½ åœ¨ç¼–è¯‘æ—¶ä¿®æ”¹ä»£ç ã€‚è¿™ç›¸å½“äº <strong>Swift ç‰ˆæœ¬çš„å…ƒç¼–ç¨‹</strong>ï¼</p>
<p><strong>ç›®æ ‡</strong>ï¼šåˆ›å»ºä¸€ä¸ª <code>@Uppercased</code> å®ï¼Œè‡ªåŠ¨å°† <code>String</code> å˜æˆå¤§å†™ã€‚</p>
<p><strong>1ï¸âƒ£ åˆ›å»º Macro Target</strong><br>åœ¨ Xcode ä¸­ï¼Œåˆ›å»º <code>Macro</code> ç›®æ ‡ï¼Œå¹¶æ·»åŠ ä»¥ä¸‹ä»£ç ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftCompilerPlugin</span><br><span class="line"><span class="keyword">import</span> SwiftSyntax</span><br><span class="line"><span class="keyword">import</span> SwiftSyntaxBuilder</span><br><span class="line"><span class="keyword">import</span> SwiftSyntaxMacros</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">struct</span> <span class="title class_">UppercasedMacro</span>: <span class="title class_">MemberMacro</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">func</span> <span class="title function_">expansion</span>(</span><br><span class="line">        <span class="params">of</span> <span class="params">node</span>: <span class="type">SwiftSyntax</span>.<span class="type">AttributeSyntax</span>,</span><br><span class="line">        <span class="params">providingMembersOf</span> <span class="params">declaration</span>: <span class="keyword">some</span> <span class="type">SwiftSyntax</span>.<span class="type">DeclSyntaxProtocol</span>,</span><br><span class="line">        <span class="params">in</span> <span class="params">context</span>: <span class="keyword">some</span> <span class="type">SwiftSyntaxMacros</span>.<span class="type">MacroExpansionContext</span></span><br><span class="line">    ) <span class="keyword">throws</span> -&gt; [<span class="type">SwiftSyntax</span>.<span class="type">DeclSyntax</span>] &#123;</span><br><span class="line">        <span class="keyword">guard</span> <span class="keyword">let</span> structDecl <span class="operator">=</span> declaration.as(<span class="type">StructDeclSyntax</span>.<span class="keyword">self</span>) <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> []</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> structDecl.memberBlock.members.compactMap &#123; member <span class="keyword">in</span></span><br><span class="line">            <span class="keyword">guard</span> <span class="keyword">let</span> varDecl <span class="operator">=</span> member.decl.as(<span class="type">VariableDeclSyntax</span>.<span class="keyword">self</span>),</span><br><span class="line">                  <span class="keyword">let</span> binding <span class="operator">=</span> varDecl.bindings.first,</span><br><span class="line">                  <span class="keyword">let</span> identifier <span class="operator">=</span> binding.pattern.as(<span class="type">IdentifierPatternSyntax</span>.<span class="keyword">self</span>) <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">let</span> uppercasedName <span class="operator">=</span> identifier.identifier.text.uppercased()</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">            var <span class="subst">\(raw: uppercasedName)</span>: String &#123; self.<span class="subst">\(identifier.identifier.text)</span>.uppercased() &#125;</span></span><br><span class="line"><span class="string">            &quot;&quot;&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<p><strong>2ï¸âƒ£ æ³¨å†Œ Macro</strong></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">@main</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">UppercasedMacroPlugin</span>: <span class="title class_">CompilerPlugin</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> providingMacros: [<span class="type">Macro</span>.<span class="keyword">Type</span>] <span class="operator">=</span> [<span class="type">UppercasedMacro</span>.<span class="keyword">self</span>]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<p><strong>3ï¸âƒ£ åœ¨ä¸»é¡¹ç›®ä¸­ä½¿ç”¨</strong></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Uppercased</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">User</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> name: <span class="type">String</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> user <span class="operator">=</span> <span class="type">User</span>(name: <span class="string">&quot;alice&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(user.<span class="type">NAME</span>) <span class="comment">// è¾“å‡º: &quot;ALICE&quot;</span></span><br></pre></td></tr></table></figure>


<p><strong>æ ¸å¿ƒçŸ¥è¯†ç‚¹</strong>ï¼š<br>âœ… <code>SwiftSyntax</code> è§£æ Swift ä»£ç å¹¶ä¿®æ”¹ ASTã€‚<br>âœ… <code>SwiftCompilerPlugin</code> è®©æˆ‘ä»¬å¯ä»¥åœ¨ <strong>ç¼–è¯‘æ—¶</strong> ç”Ÿæˆæ–°ä»£ç ã€‚<br>âœ… <code>Macro</code> æ˜¯ <strong>Swift çš„å…ƒç¼–ç¨‹èƒ½åŠ›</strong>ï¼Œèƒ½æå¤§å‡å°‘é‡å¤ä»£ç ã€‚</p>
<h2 id="ç¤ºä¾‹-2-Swift-è¿è¡Œæ—¶åŠ¨æ€æ–¹æ³•è°ƒç”¨ï¼ˆä½¿ç”¨-NSClassFromString-å’Œ-Selectorï¼‰"><a href="#ç¤ºä¾‹-2-Swift-è¿è¡Œæ—¶åŠ¨æ€æ–¹æ³•è°ƒç”¨ï¼ˆä½¿ç”¨-NSClassFromString-å’Œ-Selectorï¼‰" class="headerlink" title="ç¤ºä¾‹ 2: Swift è¿è¡Œæ—¶åŠ¨æ€æ–¹æ³•è°ƒç”¨ï¼ˆä½¿ç”¨ NSClassFromString å’Œ Selectorï¼‰"></a><strong>ç¤ºä¾‹ 2: Swift è¿è¡Œæ—¶åŠ¨æ€æ–¹æ³•è°ƒç”¨ï¼ˆä½¿ç”¨ NSClassFromString å’Œ Selectorï¼‰</strong></h2><p>åœ¨ Swift ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ <strong>è¿è¡Œæ—¶</strong> é€šè¿‡ <strong>å­—ç¬¦ä¸²</strong> åå°„åˆ›å»ºå¯¹è±¡ï¼Œå¹¶è°ƒç”¨æ–¹æ³•ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Foundation</span><br><span class="line"></span><br><span class="line"><span class="keyword">@objc</span> <span class="keyword">class</span> <span class="title class_">DynamicClass</span>: <span class="title class_">NSObject</span> &#123;</span><br><span class="line">    <span class="keyword">@objc</span> <span class="keyword">func</span> <span class="title function_">sayHello</span>() &#123;</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Hello from DynamicClass&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è¿è¡Œæ—¶åˆ›å»ºç±»å®ä¾‹</span></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">let</span> dynamicType <span class="operator">=</span> <span class="type">NSClassFromString</span>(<span class="string">&quot;DynamicClass&quot;</span>) <span class="keyword">as?</span> <span class="type">NSObject</span>.<span class="keyword">Type</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> instance <span class="operator">=</span> dynamicType.<span class="keyword">init</span>()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> selector <span class="operator">=</span> <span class="type">NSSelectorFromString</span>(<span class="string">&quot;sayHello&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> instance.responds(to: selector) &#123;</span><br><span class="line">        instance.perform(selector)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<p><strong>è¾“å‡º</strong></p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Hello <span class="keyword">from</span> DynamicClass</span><br></pre></td></tr></table></figure>


<p><strong>æ ¸å¿ƒçŸ¥è¯†ç‚¹</strong>ï¼š<br>âœ… <code>NSClassFromString(&quot;DynamicClass&quot;)</code> <strong>åŠ¨æ€è·å–ç±»</strong>ã€‚<br>âœ… <code>NSSelectorFromString(&quot;sayHello&quot;)</code> <strong>åŠ¨æ€æ–¹æ³•è°ƒç”¨</strong>ã€‚<br>âœ… Swift æœ¬èº«æ˜¯é™æ€è¯­è¨€ï¼Œä½†å¯ä»¥ç”¨ <strong>Objective-C è¿è¡Œæ—¶</strong> è¿›è¡ŒåŠ¨æ€è°ƒç”¨ã€‚</p>
<h2 id="ç¤ºä¾‹-3-ä½¿ç”¨-async-let-å®ç°è¶…é«˜æ•ˆå¹¶å‘è®¡ç®—"><a href="#ç¤ºä¾‹-3-ä½¿ç”¨-async-let-å®ç°è¶…é«˜æ•ˆå¹¶å‘è®¡ç®—" class="headerlink" title="ç¤ºä¾‹ 3: ä½¿ç”¨ async let å®ç°è¶…é«˜æ•ˆå¹¶å‘è®¡ç®—"></a><strong>ç¤ºä¾‹ 3: ä½¿ç”¨ async let å®ç°è¶…é«˜æ•ˆå¹¶å‘è®¡ç®—</strong></h2><p>ä½¿ç”¨ <code>async let</code> <strong>å¹¶å‘è¿è¡Œå¤šä¸ªä»»åŠ¡</strong>ï¼Œæå¤§æé«˜ CPU åˆ©ç”¨ç‡ã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Foundation</span><br><span class="line"></span><br><span class="line"><span class="keyword">func</span> <span class="title function_">fetchData</span>(<span class="keyword">_</span> <span class="params">id</span>: <span class="type">Int</span>) <span class="keyword">async</span> -&gt; <span class="type">Int</span> &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Fetching <span class="subst">\(id)</span>...&quot;</span>)</span><br><span class="line">    <span class="keyword">try?</span> <span class="keyword">await</span> <span class="type">Task</span>.sleep(nanoseconds: <span class="type">UInt64</span>(id) <span class="operator">*</span> <span class="number">1_000_000_000</span>)</span><br><span class="line">    <span class="keyword">return</span> id <span class="operator">*</span> <span class="number">10</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">func</span> <span class="title function_">process</span>() <span class="keyword">async</span> &#123;</span><br><span class="line">    <span class="keyword">async</span> <span class="keyword">let</span> value1 <span class="operator">=</span> fetchData(<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">async</span> <span class="keyword">let</span> value2 <span class="operator">=</span> fetchData(<span class="number">2</span>)</span><br><span class="line">    <span class="keyword">async</span> <span class="keyword">let</span> value3 <span class="operator">=</span> fetchData(<span class="number">3</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> results <span class="operator">=</span> <span class="keyword">await</span> [value1, value2, value3]</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Results: <span class="subst">\(results)</span>&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">Task</span> &#123;</span><br><span class="line">    <span class="keyword">await</span> process()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<p><strong>è¾“å‡º</strong></p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">Fetching</span> <span class="number">1</span>...</span><br><span class="line"><span class="selector-tag">Fetching</span> <span class="number">2</span>...</span><br><span class="line"><span class="selector-tag">Fetching</span> <span class="number">3</span>...</span><br><span class="line"><span class="selector-tag">Results</span>: <span class="selector-attr">[10, 20, 30]</span></span><br></pre></td></tr></table></figure>


<p><strong>æ ¸å¿ƒçŸ¥è¯†ç‚¹</strong>ï¼š<br>âœ… <code>async let</code> å¹¶è¡Œæ‰§è¡Œå¤šä¸ªä»»åŠ¡ï¼Œæ•ˆç‡è¿œè¶… <code>await</code> ä¸²è¡Œæ‰§è¡Œã€‚<br>âœ… <code>Task.sleep(nanoseconds:)</code> æ¨¡æ‹Ÿç½‘ç»œè¯·æ±‚ã€‚<br>âœ… <code>await [value1, value2, value3]</code> <strong>åŒæ—¶ç­‰å¾…å¤šä¸ªå¼‚æ­¥ä»»åŠ¡</strong>ã€‚</p>
<h2 id="ç¤ºä¾‹-4-ä½¿ç”¨-Automatic-Differentiationï¼ˆè‡ªåŠ¨å¾®åˆ†ï¼‰"><a href="#ç¤ºä¾‹-4-ä½¿ç”¨-Automatic-Differentiationï¼ˆè‡ªåŠ¨å¾®åˆ†ï¼‰" class="headerlink" title="ç¤ºä¾‹ 4: ä½¿ç”¨ Automatic Differentiationï¼ˆè‡ªåŠ¨å¾®åˆ†ï¼‰"></a><strong>ç¤ºä¾‹ 4: ä½¿ç”¨ Automatic Differentiationï¼ˆè‡ªåŠ¨å¾®åˆ†ï¼‰</strong></h2><p>Swift for TensorFlowï¼ˆS4TFï¼‰å¼•å…¥äº† <strong>è‡ªåŠ¨å¾®åˆ†</strong>ï¼Œç”¨äºæ·±åº¦å­¦ä¹ ã€æ•°å­¦è®¡ç®—ç­‰åœºæ™¯ã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> _Differentiation</span><br><span class="line"></span><br><span class="line"><span class="meta">@differentiable</span></span><br><span class="line"><span class="keyword">func</span> <span class="title function_">square</span>(<span class="keyword">_</span> <span class="params">x</span>: <span class="type">Float</span>) -&gt; <span class="type">Float</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> x <span class="operator">*</span> x</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è®¡ç®— f&#x27;(x) åœ¨ x=3 å¤„çš„å€¼</span></span><br><span class="line"><span class="keyword">let</span> df <span class="operator">=</span> gradient(of: square)(<span class="number">3</span>)</span><br><span class="line"><span class="built_in">print</span>(df) <span class="comment">// è¾“å‡º 6.0</span></span><br></pre></td></tr></table></figure>


<p><strong>æ ¸å¿ƒçŸ¥è¯†ç‚¹</strong>ï¼š<br>âœ… <code>@differentiable</code> è®© Swift <strong>è‡ªåŠ¨è®¡ç®—å¯¼æ•°</strong>ã€‚<br>âœ… <code>gradient(of: square)(3)</code> è®¡ç®— <code>f&#39;(3)</code>ï¼Œç­‰äº <code>2*x</code>ã€‚<br>âœ… é€‚ç”¨äº <strong>æœºå™¨å­¦ä¹ ã€ç§‘å­¦è®¡ç®—ã€æ•°å­¦å»ºæ¨¡</strong>ã€‚</p>
<h2 id="ç¤ºä¾‹-5-ä½¿ç”¨-UnsafeRawPointer-ç›´æ¥æ“ä½œå†…å­˜"><a href="#ç¤ºä¾‹-5-ä½¿ç”¨-UnsafeRawPointer-ç›´æ¥æ“ä½œå†…å­˜" class="headerlink" title="ç¤ºä¾‹ 5: ä½¿ç”¨ UnsafeRawPointer ç›´æ¥æ“ä½œå†…å­˜"></a><strong>ç¤ºä¾‹ 5: ä½¿ç”¨ UnsafeRawPointer ç›´æ¥æ“ä½œå†…å­˜</strong></h2><p>Swift æ˜¯ <strong>å®‰å…¨è¯­è¨€</strong>ï¼Œä½†æˆ‘ä»¬ä»å¯ä»¥ç”¨ <code>UnsafeRawPointer</code> ç›´æ¥æ“ä½œå†…å­˜ï¼</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Foundation</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> size <span class="operator">=</span> <span class="type">MemoryLayout</span>.size</span><br><span class="line"><span class="keyword">let</span> pointer <span class="operator">=</span> <span class="type">UnsafeMutableRawPointer</span>.allocate(byteCount: size, alignment: <span class="type">MemoryLayout</span>.alignment)</span><br><span class="line"></span><br><span class="line">pointer.storeBytes(of: <span class="number">42</span>, as: <span class="type">Int</span>.<span class="keyword">self</span>)</span><br><span class="line"><span class="keyword">let</span> value: <span class="type">Int</span> <span class="operator">=</span> pointer.load(as: <span class="type">Int</span>.<span class="keyword">self</span>)</span><br><span class="line"><span class="built_in">print</span>(value) <span class="comment">// 42</span></span><br><span class="line"></span><br><span class="line">pointer.deallocate()</span><br></pre></td></tr></table></figure>


<p><strong>æ ¸å¿ƒçŸ¥è¯†ç‚¹</strong>ï¼š<br>âœ… <code>UnsafeMutableRawPointer.allocate</code> ç›´æ¥åˆ†é…å†…å­˜ã€‚<br>âœ… <code>storeBytes(of:as:)</code> æ‰‹åŠ¨å­˜å‚¨å€¼ã€‚<br>âœ… <code>load(as:)</code> ç›´æ¥ä»å†…å­˜è¯»å–ã€‚<br>âœ… âš  <strong>è¿™ä¼šç»•è¿‡ Swift çš„ç±»å‹å®‰å…¨æ€§</strong>ï¼Œå°å¿ƒä½¿ç”¨ï¼</p>
<h2 id="ç¤ºä¾‹-6-ä½¿ç”¨-Generative-Type-åˆ›å»ºè‡ªæ‰©å±•ç»“æ„"><a href="#ç¤ºä¾‹-6-ä½¿ç”¨-Generative-Type-åˆ›å»ºè‡ªæ‰©å±•ç»“æ„" class="headerlink" title="ç¤ºä¾‹ 6: ä½¿ç”¨ Generative Type åˆ›å»ºè‡ªæ‰©å±•ç»“æ„"></a><strong>ç¤ºä¾‹ 6: ä½¿ç”¨ Generative Type åˆ›å»ºè‡ªæ‰©å±•ç»“æ„</strong></h2><p><strong>ç›®æ ‡</strong>ï¼šåˆ›å»ºä¸€ä¸ª <strong>å¯ä»¥åŠ¨æ€æ‰©å±•è‡ªèº«çš„æ–¹æ³•</strong> çš„ç»“æ„ä½“ï¼</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">protocol</span> <span class="title class_">Expandable</span> &#123;</span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">expand</span>() -&gt; <span class="keyword">Self</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Number</span>: <span class="title class_">Expandable</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> value: <span class="type">Int</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">func</span> <span class="title function_">expand</span>() -&gt; <span class="type">Number</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="type">Number</span>(value: <span class="keyword">self</span>.value <span class="operator">*</span> <span class="number">2</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> num <span class="operator">=</span> <span class="type">Number</span>(value: <span class="number">10</span>)</span><br><span class="line"><span class="keyword">let</span> expanded <span class="operator">=</span> num.expand().expand().expand()</span><br><span class="line"><span class="built_in">print</span>(expanded.value) <span class="comment">// 80</span></span><br></pre></td></tr></table></figure>


<p><strong>æ ¸å¿ƒçŸ¥è¯†ç‚¹</strong>ï¼š<br>âœ… <code>Self</code> å…³é”®å­—ï¼Œç¡®ä¿æ–¹æ³•è¿”å› <strong>ç›¸åŒç±»å‹çš„å®ä¾‹</strong>ã€‚<br>âœ… é€‚ç”¨äº <strong>é€’å½’å¼æ‰©å±•ï¼Œå¦‚æ•°å­¦è®¡ç®—ã€æ•°æ®ç»“æ„å¢é•¿</strong>ã€‚</p>
<h2 id="ç»ˆææŒ‘æˆ˜"><a href="#ç»ˆææŒ‘æˆ˜" class="headerlink" title="ç»ˆææŒ‘æˆ˜"></a><strong>ç»ˆææŒ‘æˆ˜</strong></h2><p>å¦‚æœä½ æƒ³æŒ‘æˆ˜è‡ªå·±ï¼Œå¯ä»¥å°è¯•ï¼š<br>1ï¸âƒ£ <strong>ä½¿ç”¨ macro ç”Ÿæˆ Codable ä»£ç </strong>ã€‚<br>2ï¸âƒ£ <strong>ç”¨ actor + Distributed è¿›è¡Œå¤šèŠ‚ç‚¹åˆ†å¸ƒå¼è®¡ç®—</strong>ã€‚<br>3ï¸âƒ£ <strong>ç”¨ UnsafeMutablePointer åˆ›å»ºæ‰‹å†™çš„é“¾è¡¨æˆ–æ•°ç»„æ± </strong>ã€‚<br>4ï¸âƒ£ <strong>ä½¿ç”¨ Reflection åˆ›å»º ORMï¼ˆå¯¹è±¡å…³ç³»æ˜ å°„ï¼‰</strong>ã€‚</p>
<p>è¿™äº›ç¤ºä¾‹å±•ç¤ºäº† <strong>Swift çš„æœ€é«˜çº§ç‰¹æ€§</strong>ï¼ŒåŒ…æ‹¬ <strong>å®ã€è‡ªåŠ¨å¾®åˆ†ã€åå°„ã€åŠ¨æ€ç±»å‹ã€å¹¶å‘æ§åˆ¶</strong>ã€‚å¦‚æœä½ æƒ³åœ¨ Swift é«˜çº§å¼€å‘ä¸­æ›´è¿›ä¸€æ­¥ï¼Œå¿«è¯•è¯•è¿™äº›ä»£ç å§ï¼ğŸš€</p>
<h1 id="æ›´éš¾çš„"><a href="#æ›´éš¾çš„" class="headerlink" title="æ›´éš¾çš„"></a>æ›´éš¾çš„</h1><p>ä½ è¿½æ±‚æ›´æè‡´çš„ Swift é«˜çº§æŒ‘æˆ˜ï¼Ÿä»Šå¤©æˆ‘ä»¬æ·±å…¥ <strong>Swift è¿è¡Œæ—¶ï¼ˆRuntimeï¼‰ã€LLVM IR ä»£ç ç”Ÿæˆã€JITï¼ˆå³æ—¶ç¼–è¯‘ï¼‰ã€åˆ†å¸ƒå¼è®¡ç®—ã€å¼‚æ„è®¡ç®—ï¼ˆMetalï¼‰ã€ä»£ç è‡ªæˆ‘ä¿®æ”¹ï¼ˆSelf-Modifying Codeï¼‰</strong> è¿™äº›çœŸæ­£é«˜é˜¶çš„æŠ€æœ¯é¢†åŸŸï¼ğŸš€</p>
<h2 id="ç¤ºä¾‹-1-ä½¿ç”¨-LLVM-IR-ç›´æ¥ç”Ÿæˆæœºå™¨ç ï¼ˆSwift-ç¼–è¯‘å™¨åº•å±‚ï¼‰"><a href="#ç¤ºä¾‹-1-ä½¿ç”¨-LLVM-IR-ç›´æ¥ç”Ÿæˆæœºå™¨ç ï¼ˆSwift-ç¼–è¯‘å™¨åº•å±‚ï¼‰" class="headerlink" title="ç¤ºä¾‹ 1: ä½¿ç”¨ LLVM IR ç›´æ¥ç”Ÿæˆæœºå™¨ç ï¼ˆSwift ç¼–è¯‘å™¨åº•å±‚ï¼‰"></a><strong>ç¤ºä¾‹ 1: ä½¿ç”¨ LLVM IR ç›´æ¥ç”Ÿæˆæœºå™¨ç </strong>ï¼ˆSwift ç¼–è¯‘å™¨åº•å±‚ï¼‰</h2><p>Swift æœ¬è´¨ä¸Šæ˜¯ <strong>LLVM IRï¼ˆä¸­é—´è¡¨ç¤ºï¼‰</strong> çš„ä¸€ä¸ªå‰ç«¯ã€‚ä½ å¯ä»¥ç›´æ¥ç”¨ Swift ä»£ç ç”Ÿæˆ LLVM IRï¼Œç„¶åè®©å®ƒå˜æˆæœºå™¨ç ã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Foundation</span><br><span class="line"></span><br><span class="line"><span class="keyword">func</span> <span class="title function_">emitLLVMIR</span>(<span class="params">for</span> <span class="params">source</span>: <span class="type">String</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> process <span class="operator">=</span> <span class="type">Process</span>()</span><br><span class="line">    process.executableURL <span class="operator">=</span> <span class="type">URL</span>(fileURLWithPath: <span class="string">&quot;/usr/bin/swiftc&quot;</span>)</span><br><span class="line">    process.arguments <span class="operator">=</span> [<span class="string">&quot;-emit-llvm&quot;</span>, <span class="string">&quot;-o&quot;</span>, <span class="string">&quot;/tmp/output.ll&quot;</span>, <span class="string">&quot;-&quot;</span>]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> inputPipe <span class="operator">=</span> <span class="type">Pipe</span>()</span><br><span class="line">    process.standardInput <span class="operator">=</span> inputPipe</span><br><span class="line">    process.launch()</span><br><span class="line"></span><br><span class="line">    inputPipe.fileHandleForWriting.write(source.data(using: .utf8)<span class="operator">!</span>)</span><br><span class="line">    inputPipe.fileHandleForWriting.closeFile()</span><br><span class="line">    </span><br><span class="line">    process.waitUntilExit()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;LLVM IR generated at /tmp/output.ll&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç”Ÿæˆ LLVM IR</span></span><br><span class="line">emitLLVMIR(for: <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">func add(_ a: Int, _ b: Int) -&gt; Int &#123;</span></span><br><span class="line"><span class="string">    return a + b</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span>)</span><br></pre></td></tr></table></figure>


<p><strong>æ ¸å¿ƒçŸ¥è¯†ç‚¹</strong>ï¼š<br>âœ… ç›´æ¥è°ƒç”¨ Swift ç¼–è¯‘å™¨ç”Ÿæˆ LLVM IR ä»£ç ã€‚<br>âœ… å¯ç”¨äº <strong>é«˜çº§ç¼–è¯‘å™¨ä¼˜åŒ–ã€JIT æ‰§è¡Œã€è‡ªå®šä¹‰ä»£ç åˆ†æ</strong>ã€‚<br>âœ… é€‚åˆ <strong>ç ”ç©¶ Swift ä»£ç å¦‚ä½•è½¬æ¢æˆæ±‡ç¼–æŒ‡ä»¤</strong>ã€‚</p>
<h2 id="ç¤ºä¾‹-2-Swift-è¿è¡Œæ—¶ï¼ˆRuntimeï¼‰åŠ¨æ€æ›¿æ¢æ–¹æ³•"><a href="#ç¤ºä¾‹-2-Swift-è¿è¡Œæ—¶ï¼ˆRuntimeï¼‰åŠ¨æ€æ›¿æ¢æ–¹æ³•" class="headerlink" title="ç¤ºä¾‹ 2: Swift è¿è¡Œæ—¶ï¼ˆRuntimeï¼‰åŠ¨æ€æ›¿æ¢æ–¹æ³•"></a><strong>ç¤ºä¾‹ 2: Swift è¿è¡Œæ—¶ï¼ˆRuntimeï¼‰åŠ¨æ€æ›¿æ¢æ–¹æ³•</strong></h2><p>åˆ©ç”¨ Swift è¿è¡Œæ—¶ï¼Œ<strong>åœ¨è¿è¡Œæ—¶æ›¿æ¢ç±»çš„æ–¹æ³•</strong>ï¼Œç±»ä¼¼äº Python çš„ <code>monkey patching</code>ã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> ObjectiveC</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">TargetClass</span>: <span class="title class_">NSObject</span> &#123;</span><br><span class="line">    <span class="keyword">@objc</span> <span class="keyword">dynamic</span> <span class="keyword">func</span> <span class="title function_">originalMethod</span>() &#123;</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Original Method&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">func</span> <span class="title function_">swizzledMethod</span>(<span class="params">self</span>: <span class="type">AnyObject</span>, <span class="keyword">_</span> <span class="params">cmd</span>: <span class="type">Selector</span>) &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Swizzled Method&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> method <span class="operator">=</span> class_getInstanceMethod(<span class="type">TargetClass</span>.<span class="keyword">self</span>, <span class="keyword">#selector</span>(<span class="type">TargetClass</span>.originalMethod))<span class="operator">!</span></span><br><span class="line"><span class="keyword">let</span> newIMP <span class="operator">=</span> imp_implementationWithBlock(swizzledMethod <span class="keyword">as</span> <span class="keyword">@convention(block)</span> (<span class="type">AnyObject</span>, <span class="type">Selector</span>) -&gt; <span class="type">Void</span>)</span><br><span class="line">method_setImplementation(method, newIMP)</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> instance <span class="operator">=</span> <span class="type">TargetClass</span>()</span><br><span class="line">instance.originalMethod()  <span class="comment">// è¾“å‡º: &quot;Swizzled Method&quot;</span></span><br></pre></td></tr></table></figure>


<p><strong>æ ¸å¿ƒçŸ¥è¯†ç‚¹</strong>ï¼š<br>âœ… <code>class_getInstanceMethod</code> è·å–æ–¹æ³•æŒ‡é’ˆã€‚<br>âœ… <code>imp_implementationWithBlock</code> ç”Ÿæˆæ–°çš„æ–¹æ³•å®ç°ã€‚<br>âœ… <code>method_setImplementation</code> åŠ¨æ€æ›¿æ¢æ–¹æ³•ï¼Œç±»ä¼¼ <strong>AOPï¼ˆé¢å‘åˆ‡é¢ç¼–ç¨‹ï¼‰</strong>ã€‚<br>âœ… é€‚ç”¨äº <strong>çƒ­ä¿®å¤ã€æ—¥å¿—æ³¨å…¥ã€åŠ¨æ€è°ƒè¯•</strong>ã€‚</p>
<h2 id="ç¤ºä¾‹-3-ç”¨-Swift-ç¼–å†™-JIT-ç¼–è¯‘å™¨"><a href="#ç¤ºä¾‹-3-ç”¨-Swift-ç¼–å†™-JIT-ç¼–è¯‘å™¨" class="headerlink" title="ç¤ºä¾‹ 3: ç”¨ Swift ç¼–å†™ JIT ç¼–è¯‘å™¨"></a><strong>ç¤ºä¾‹ 3: ç”¨ Swift ç¼–å†™ JIT ç¼–è¯‘å™¨</strong></h2><p>Swift ä¸èƒ½ç›´æ¥ JIT ç¼–è¯‘ä»£ç ï¼Œä½†æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <strong>LLVM ORC JIT</strong> è¿›è¡Œè¿è¡Œæ—¶ä»£ç ç”Ÿæˆã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Foundation</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> jitCode <span class="operator">=</span> <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">#include </span></span><br><span class="line"><span class="string">void execute() &#123;</span></span><br><span class="line"><span class="string">    printf(&quot;Hello from JIT!<span class="subst">\\</span>n&quot;);</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">func</span> <span class="title function_">compileAndRunC</span>(<span class="keyword">_</span> <span class="params">source</span>: <span class="type">String</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> tempFile <span class="operator">=</span> <span class="string">&quot;/tmp/jit_code.c&quot;</span></span><br><span class="line">    <span class="keyword">let</span> binaryFile <span class="operator">=</span> <span class="string">&quot;/tmp/jit_executable&quot;</span></span><br><span class="line">    <span class="keyword">try?</span> source.write(toFile: tempFile, atomically: <span class="literal">true</span>, encoding: .utf8)</span><br><span class="line"></span><br><span class="line">    system(<span class="string">&quot;clang <span class="subst">\(tempFile)</span> -o <span class="subst">\(binaryFile)</span>&quot;</span>)</span><br><span class="line">    system(binaryFile)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">compileAndRunC(jitCode)</span><br></pre></td></tr></table></figure>


<p><strong>æ ¸å¿ƒçŸ¥è¯†ç‚¹</strong>ï¼š<br>âœ… <code>system()</code> <strong>åœ¨è¿è¡Œæ—¶ç¼–è¯‘å¹¶æ‰§è¡Œä»£ç </strong>ã€‚<br>âœ… ç±»ä¼¼äº **Python çš„ exec()**ï¼Œå¯ä»¥æ‰§è¡Œä»»æ„ä»£ç ã€‚<br>âœ… é€‚ç”¨äº <strong>è‡ªå®šä¹‰ DSLã€æ’ä»¶ç³»ç»Ÿã€åŠ¨æ€ä»£ç ç”Ÿæˆ</strong>ã€‚</p>
<h2 id="ç¤ºä¾‹-4-Swift-åˆ†å¸ƒå¼è®¡ç®—"><a href="#ç¤ºä¾‹-4-Swift-åˆ†å¸ƒå¼è®¡ç®—" class="headerlink" title="ç¤ºä¾‹ 4: Swift åˆ†å¸ƒå¼è®¡ç®—"></a><strong>ç¤ºä¾‹ 4: Swift åˆ†å¸ƒå¼è®¡ç®—</strong></h2><p>Swift <strong>åˆ†å¸ƒå¼ actor</strong> å…è®¸ä½ åœ¨å¤šä¸ªæœºå™¨é—´å®‰å…¨åœ°å…±äº«çŠ¶æ€ã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">distributed</span> <span class="keyword">actor</span> <span class="title class_">Node</span> &#123;</span><br><span class="line">    <span class="keyword">distributed</span> <span class="keyword">func</span> <span class="title function_">compute</span>(<span class="params">value</span>: <span class="type">Int</span>) -&gt; <span class="type">Int</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> value <span class="operator">*</span> <span class="number">2</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> node <span class="operator">=</span> <span class="type">Node</span>(actorSystem: <span class="type">ClusterSystem</span>())</span><br><span class="line"><span class="keyword">let</span> result <span class="operator">=</span> <span class="keyword">await</span> node.compute(value: <span class="number">10</span>)</span><br><span class="line"><span class="built_in">print</span>(result) <span class="comment">// 20</span></span><br></pre></td></tr></table></figure>


<p><strong>æ ¸å¿ƒçŸ¥è¯†ç‚¹</strong>ï¼š<br>âœ… <code>distributed actor</code> è®© actor å¯ä»¥ <strong>è·¨æœºå™¨</strong> è¿è¡Œã€‚<br>âœ… <code>ClusterSystem</code> è®©å¤šä¸ª <strong>Swift è¿›ç¨‹ç»„æˆè®¡ç®—é›†ç¾¤</strong>ã€‚<br>âœ… å¯ç”¨äº <strong>åˆ†å¸ƒå¼è®¡ç®—ã€äº‘è®¡ç®—</strong>ã€‚</p>
<h2 id="ç¤ºä¾‹-5-ä½¿ç”¨-Metal-è¿›è¡Œå¼‚æ„è®¡ç®—ï¼ˆGPU-åŠ é€Ÿï¼‰"><a href="#ç¤ºä¾‹-5-ä½¿ç”¨-Metal-è¿›è¡Œå¼‚æ„è®¡ç®—ï¼ˆGPU-åŠ é€Ÿï¼‰" class="headerlink" title="ç¤ºä¾‹ 5: ä½¿ç”¨ Metal è¿›è¡Œå¼‚æ„è®¡ç®—ï¼ˆGPU åŠ é€Ÿï¼‰"></a><strong>ç¤ºä¾‹ 5: ä½¿ç”¨ Metal è¿›è¡Œå¼‚æ„è®¡ç®—ï¼ˆGPU åŠ é€Ÿï¼‰</strong></h2><p>æˆ‘ä»¬å¯ä»¥ç›´æ¥åœ¨ Swift ä¸­ä½¿ç”¨ <strong>Metal</strong>ï¼Œè®©ä»£ç è·‘åœ¨ GPU ä¸Šï¼Œ<strong>æ¯” CPU å¿« 100 å€</strong>ï¼</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Metal</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> device <span class="operator">=</span> <span class="type">MTLCreateSystemDefaultDevice</span>()<span class="operator">!</span></span><br><span class="line"><span class="keyword">let</span> commandQueue <span class="operator">=</span> device.makeCommandQueue()<span class="operator">!</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> kernelSource <span class="operator">=</span> <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">kernel void add_one(device int *data [[buffer(0)]], uint id [[thread_position_in_grid]]) &#123;</span></span><br><span class="line"><span class="string">    data[id] += 1;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> library <span class="operator">=</span> <span class="keyword">try</span> device.makeLibrary(source: kernelSource, options: <span class="literal">nil</span>)</span><br><span class="line"><span class="keyword">let</span> function <span class="operator">=</span> library.makeFunction(name: <span class="string">&quot;add_one&quot;</span>)<span class="operator">!</span></span><br><span class="line"><span class="keyword">let</span> computePipeline <span class="operator">=</span> <span class="keyword">try</span> device.makeComputePipelineState(function: function)</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> buffer <span class="operator">=</span> device.makeBuffer(length: <span class="number">4</span> <span class="operator">*</span> <span class="type">MemoryLayout</span>.size, options: [])<span class="operator">!</span></span><br><span class="line"><span class="keyword">var</span> numbers <span class="operator">=</span> [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>]</span><br><span class="line">buffer.contents().copyMemory(from: <span class="operator">&amp;</span>numbers, byteCount: numbers.count <span class="operator">*</span> <span class="type">MemoryLayout</span>.size)</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> commandBuffer <span class="operator">=</span> commandQueue.makeCommandBuffer()<span class="operator">!</span></span><br><span class="line"><span class="keyword">let</span> computeEncoder <span class="operator">=</span> commandBuffer.makeComputeCommandEncoder()<span class="operator">!</span></span><br><span class="line">computeEncoder.setComputePipelineState(computePipeline)</span><br><span class="line">computeEncoder.setBuffer(buffer, offset: <span class="number">0</span>, index: <span class="number">0</span>)</span><br><span class="line">computeEncoder.dispatchThreads(<span class="type">MTLSize</span>(width: numbers.count, height: <span class="number">1</span>, depth: <span class="number">1</span>), threadsPerThreadgroup: <span class="type">MTLSize</span>(width: <span class="number">1</span>, height: <span class="number">1</span>, depth: <span class="number">1</span>))</span><br><span class="line">computeEncoder.endEncoding()</span><br><span class="line">commandBuffer.commit()</span><br><span class="line">commandBuffer.waitUntilCompleted()</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> result <span class="operator">=</span> buffer.contents().assumingMemoryBound(to: <span class="type">Int</span>.<span class="keyword">self</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;GPU è®¡ç®—ç»“æœ: <span class="subst">\(result[<span class="number">0</span>])</span>, <span class="subst">\(result[<span class="number">1</span>])</span>, <span class="subst">\(result[<span class="number">2</span>])</span>, <span class="subst">\(result[<span class="number">3</span>])</span>&quot;</span>) <span class="comment">// 2, 3, 4, 5</span></span><br></pre></td></tr></table></figure>


<p><strong>æ ¸å¿ƒçŸ¥è¯†ç‚¹</strong>ï¼š<br>âœ… <code>MTLCreateSystemDefaultDevice()</code> è·å– GPU è®¾å¤‡ã€‚<br>âœ… <code>dispatchThreads()</code> è®© GPU å¹¶è¡Œè®¡ç®—æ•°æ®ã€‚<br>âœ… å¯ç”¨äº <strong>æœºå™¨å­¦ä¹ ã€å›¾åƒå¤„ç†ã€ç§‘å­¦è®¡ç®—</strong>ã€‚</p>
<h2 id="ç¤ºä¾‹-6-Self-Modifying-Codeï¼ˆä»£ç è‡ªæˆ‘ä¿®æ”¹ï¼‰"><a href="#ç¤ºä¾‹-6-Self-Modifying-Codeï¼ˆä»£ç è‡ªæˆ‘ä¿®æ”¹ï¼‰" class="headerlink" title="ç¤ºä¾‹ 6: Self-Modifying Codeï¼ˆä»£ç è‡ªæˆ‘ä¿®æ”¹ï¼‰"></a><strong>ç¤ºä¾‹ 6: Self-Modifying Codeï¼ˆä»£ç è‡ªæˆ‘ä¿®æ”¹ï¼‰</strong></h2><p>Swift æœ¬èº« <strong>ç¦æ­¢è‡ªæˆ‘ä¿®æ”¹ä»£ç </strong>ï¼Œä½†æˆ‘ä»¬å¯ä»¥ç”¨ <code>mprotect()</code> ç»•è¿‡ã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Foundation</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> code: [<span class="type">UInt8</span>] <span class="operator">=</span> [</span><br><span class="line">    <span class="number">0x48</span>, <span class="number">0xC7</span>, <span class="number">0xC0</span>, <span class="number">0x2A</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="comment">// mov rax, 42</span></span><br><span class="line">    <span class="number">0xC3</span>                                     <span class="comment">// ret</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> ptr <span class="operator">=</span> mmap(<span class="literal">nil</span>, <span class="number">4096</span>, <span class="type">PROT_READ</span> <span class="operator">|</span> <span class="type">PROT_WRITE</span> <span class="operator">|</span> <span class="type">PROT_EXEC</span>, <span class="type">MAP_ANONYMOUS</span> <span class="operator">|</span> <span class="type">MAP_PRIVATE</span>, <span class="operator">-</span><span class="number">1</span>, <span class="number">0</span>)<span class="operator">!</span></span><br><span class="line">memcpy(ptr, code, code.count)</span><br><span class="line"></span><br><span class="line"><span class="keyword">typealias</span> <span class="type">Function</span> <span class="operator">=</span> <span class="keyword">@convention(c)</span> () -&gt; <span class="type">Int</span></span><br><span class="line"><span class="keyword">let</span> function <span class="operator">=</span> <span class="built_in">unsafeBitCast</span>(ptr, to: <span class="type">Function</span>.<span class="keyword">self</span>)</span><br><span class="line"><span class="built_in">print</span>(function()) <span class="comment">// è¾“å‡º 42</span></span><br></pre></td></tr></table></figure>


<p><strong>æ ¸å¿ƒçŸ¥è¯†ç‚¹</strong>ï¼š<br>âœ… <code>mmap()</code> ç”³è¯· <strong>å¯æ‰§è¡Œå†…å­˜</strong>ã€‚<br>âœ… <code>memcpy()</code> <strong>åŠ¨æ€ä¿®æ”¹ä»£ç </strong>ã€‚<br>âœ… <code>unsafeBitCast()</code> è®© Swift è°ƒç”¨ <strong>æ‰‹å†™æœºå™¨ç </strong>ã€‚<br>âœ… <strong>æç«¯æƒ…å†µä¸‹å¯ç”¨äº JITã€è™šæ‹Ÿæœºã€æ²™ç›’é€ƒé€¸</strong>ã€‚âš  <strong>å±é™©æ“ä½œï¼Œéœ€è°¨æ…ä½¿ç”¨ï¼</strong></p>
<h2 id="ç»ˆææŒ‘æˆ˜-1"><a href="#ç»ˆææŒ‘æˆ˜-1" class="headerlink" title="ç»ˆææŒ‘æˆ˜"></a><strong>ç»ˆææŒ‘æˆ˜</strong></h2><p>å¦‚æœä½ è§‰å¾—è¿˜ä¸å¤Ÿéš¾ï¼Œè¯•è¯•ï¼š<br>1ï¸âƒ£ <strong>ç”¨ Swift å®ç°ä¸€ä¸ª Tiny Swift è§£é‡Šå™¨</strong>ï¼ˆç”¨ Swift è§£æ Swiftï¼‰ã€‚<br>2ï¸âƒ£ <strong>ç”¨ Swift ç¼–å†™ä¸€ä¸ªè‡ªå®šä¹‰ CPU æŒ‡ä»¤é›†æ¨¡æ‹Ÿå™¨</strong>ã€‚<br>3ï¸âƒ£ <strong>ç”¨ Metal å’Œ Swift å®ç°ä¸€ä¸ª GPU åŠ é€Ÿçš„ AI æ¨ç†å¼•æ“</strong>ã€‚<br>4ï¸âƒ£ <strong>ç”¨ Swift è¿è¡Œæ—¶è‡ªåŠ¨ç”Ÿæˆå’Œè°ƒç”¨ Objective-C ä»£ç </strong>ã€‚<br>5ï¸âƒ£ <strong>ç”¨ Swift + WebAssembly è®©ä»£ç åœ¨æµè§ˆå™¨ä¸­è¿è¡Œ</strong>ã€‚</p>
<p>è¿™äº›éƒ½æ˜¯ <strong>æé™çº§åˆ«</strong> çš„ Swift ç©æ³•ï¼æœ‰å…´è¶£çš„è¯ï¼ŒæŒ‘ä¸€ä¸ªæ¥æŒ‘æˆ˜å§ï¼ğŸš€</p>

    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/swift%E7%BC%96%E7%A8%8B/" rel="tag"># swiftç¼–ç¨‹</a>
              <a href="/tags/%E4%BB%A3%E7%A0%81%E7%A4%BA%E4%BE%8B/" rel="tag"># ä»£ç ç¤ºä¾‹</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2025/03/29/swiftui%E4%B8%AD%E7%9A%84lazyVGrid%E7%94%A8%E6%B3%95/" rel="prev" title="swiftuiä¸­çš„lazyVGridç”¨æ³•">
      <i class="fa fa-chevron-left"></i> swiftuiä¸­çš„lazyVGridç”¨æ³•
    </a></div>
      <div class="post-nav-item">
    <a href="/2025/04/23/Macbook%E5%BF%AB%E6%8D%B7%E9%94%AE%E7%9A%84%E8%AE%BE%E8%AE%A1%E7%90%86%E5%BF%B5/" rel="next" title="Macbookå¿«æ·é”®çš„è®¾è®¡ç†å¿µ">
      Macbookå¿«æ·é”®çš„è®¾è®¡ç†å¿µ <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          æ–‡ç« ç›®å½•
        </li>
        <li class="sidebar-nav-overview">
          ç«™ç‚¹æ¦‚è§ˆ
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#swift%E4%BB%A3%E7%A0%81%E6%8E%A8%E8%8D%90"><span class="nav-text">swiftä»£ç æ¨è</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%A4%BA%E4%BE%8B-1-%E4%BD%BF%E7%94%A8-map-%E8%BF%9B%E8%A1%8C%E8%BD%AC%E6%8D%A2"><span class="nav-text">ç¤ºä¾‹ 1: ä½¿ç”¨ map è¿›è¡Œè½¬æ¢</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%A4%BA%E4%BE%8B-2-%E4%BD%BF%E7%94%A8-filter-%E8%BF%9B%E8%A1%8C%E7%AD%9B%E9%80%89"><span class="nav-text">ç¤ºä¾‹ 2: ä½¿ç”¨ filter è¿›è¡Œç­›é€‰</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%A4%BA%E4%BE%8B-3-%E4%BD%BF%E7%94%A8-reduce-%E8%BF%9B%E8%A1%8C%E6%B1%82%E5%92%8C"><span class="nav-text">ç¤ºä¾‹ 3: ä½¿ç”¨ reduce è¿›è¡Œæ±‚å’Œ</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%80%BB%E7%BB%93%EF%BC%9A"><span class="nav-text">æ€»ç»“ï¼š</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%B8%80%E4%BA%9B%E6%9B%B4%E9%AB%98%E7%BA%A7%E7%9A%84-Swift-%E4%BB%A3%E7%A0%81%E7%A4%BA%E4%BE%8B%EF%BC%8C%E6%B6%89%E5%8F%8A-%E6%B3%9B%E5%9E%8B%E3%80%81%E9%AB%98%E9%98%B6%E5%87%BD%E6%95%B0%E3%80%81%E7%BB%84%E5%90%88%E5%BC%8F%E5%87%BD%E6%95%B0%E5%BC%8F%E7%BC%96%E7%A8%8B%E3%80%81%E5%B1%9E%E6%80%A7%E5%8C%85%E8%A3%85%E5%99%A8%E3%80%81Async-x2F-Await-%E5%B9%B6%E5%8F%91-%E7%AD%89%E5%86%85%E5%AE%B9%E3%80%82"><span class="nav-text">ä¸€äº›æ›´é«˜çº§çš„ Swift ä»£ç ç¤ºä¾‹ï¼Œæ¶‰åŠ æ³›å‹ã€é«˜é˜¶å‡½æ•°ã€ç»„åˆå¼å‡½æ•°å¼ç¼–ç¨‹ã€å±æ€§åŒ…è£…å™¨ã€Async&#x2F;Await å¹¶å‘ ç­‰å†…å®¹ã€‚</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%A4%BA%E4%BE%8B-1-%E6%B3%9B%E5%9E%8B-%E5%85%B3%E8%81%94%E7%B1%BB%E5%9E%8B-%E5%8D%8F%E8%AE%AE"><span class="nav-text">ç¤ºä¾‹ 1: æ³›å‹ + å…³è”ç±»å‹ + åè®®</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%A4%BA%E4%BE%8B-2-%E9%AB%98%E9%98%B6%E5%87%BD%E6%95%B0-amp-%E7%BB%84%E5%90%88%E5%BC%8F%E7%BC%96%E7%A8%8B"><span class="nav-text">ç¤ºä¾‹ 2: é«˜é˜¶å‡½æ•° &amp; ç»„åˆå¼ç¼–ç¨‹</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%A4%BA%E4%BE%8B-3-%E8%87%AA%E5%AE%9A%E4%B9%89%E5%B1%9E%E6%80%A7%E5%8C%85%E8%A3%85%E5%99%A8"><span class="nav-text">ç¤ºä¾‹ 3: è‡ªå®šä¹‰å±æ€§åŒ…è£…å™¨</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%A4%BA%E4%BE%8B-4-Async-x2F-Await-%E5%B9%B6%E5%8F%91"><span class="nav-text">ç¤ºä¾‹ 4: Async&#x2F;Await å¹¶å‘</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%B6%89%E5%8F%8A-%E9%AB%98%E7%BA%A7%E6%B3%9B%E5%9E%8B%E3%80%81Combine-%E5%93%8D%E5%BA%94%E5%BC%8F%E7%BC%96%E7%A8%8B%E3%80%81Actor-%E5%B9%B6%E5%8F%91%E5%AE%89%E5%85%A8%E3%80%81Swift-%E5%8F%8D%E5%B0%84%EF%BC%88Mirror%EF%BC%89%EF%BC%8C%E4%BB%A5%E5%8F%8A-DSL%EF%BC%88%E9%A2%86%E5%9F%9F%E7%89%B9%E5%AE%9A%E8%AF%AD%E8%A8%80%EF%BC%89%E8%AE%BE%E8%AE%A1%E3%80%82"><span class="nav-text">æ¶‰åŠ é«˜çº§æ³›å‹ã€Combine å“åº”å¼ç¼–ç¨‹ã€Actor å¹¶å‘å®‰å…¨ã€Swift åå°„ï¼ˆMirrorï¼‰ï¼Œä»¥åŠ DSLï¼ˆé¢†åŸŸç‰¹å®šè¯­è¨€ï¼‰è®¾è®¡ã€‚</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%A4%BA%E4%BE%8B-1-%E7%BB%93%E5%90%88%E6%B3%9B%E5%9E%8B%E3%80%81%E5%8D%8F%E8%AE%AE%E5%92%8C%E4%BE%9D%E8%B5%96%E6%B3%A8%E5%85%A5"><span class="nav-text">ç¤ºä¾‹ 1: ç»“åˆæ³›å‹ã€åè®®å’Œä¾èµ–æ³¨å…¥</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%85%B3%E9%94%AE%E7%82%B9"><span class="nav-text">å…³é”®ç‚¹</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%A4%BA%E4%BE%8B-2-%E4%BD%BF%E7%94%A8-Combine-%E8%BF%9B%E8%A1%8C%E5%93%8D%E5%BA%94%E5%BC%8F%E6%95%B0%E6%8D%AE%E6%B5%81"><span class="nav-text">ç¤ºä¾‹ 2: ä½¿ç”¨ Combine è¿›è¡Œå“åº”å¼æ•°æ®æµ</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%85%B3%E9%94%AE%E7%82%B9-1"><span class="nav-text">å…³é”®ç‚¹</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%A4%BA%E4%BE%8B-3-%E4%BD%BF%E7%94%A8-actor-%E4%BF%9D%E6%8A%A4%E5%85%B1%E4%BA%AB%E8%B5%84%E6%BA%90"><span class="nav-text">ç¤ºä¾‹ 3: ä½¿ç”¨ actor ä¿æŠ¤å…±äº«èµ„æº</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%85%B3%E9%94%AE%E7%82%B9-2"><span class="nav-text">å…³é”®ç‚¹</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%A4%BA%E4%BE%8B-4-%E4%BD%BF%E7%94%A8-Mirror-%E8%BF%9B%E8%A1%8C-Swift-%E5%8F%8D%E5%B0%84"><span class="nav-text">ç¤ºä¾‹ 4: ä½¿ç”¨ Mirror è¿›è¡Œ Swift åå°„</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%85%B3%E9%94%AE%E7%82%B9-3"><span class="nav-text">å…³é”®ç‚¹</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%A4%BA%E4%BE%8B-5-%E8%AE%BE%E8%AE%A1-DSL%EF%BC%88%E9%A2%86%E5%9F%9F%E7%89%B9%E5%AE%9A%E8%AF%AD%E8%A8%80%EF%BC%89"><span class="nav-text">ç¤ºä¾‹ 5: è®¾è®¡ DSLï¼ˆé¢†åŸŸç‰¹å®šè¯­è¨€ï¼‰</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%85%B3%E9%94%AE%E7%82%B9-4"><span class="nav-text">å…³é”®ç‚¹</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%80%BB%E7%BB%93"><span class="nav-text">æ€»ç»“</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E9%82%A3%E4%BB%8A%E5%A4%A9%E6%88%91%E4%BB%AC%E6%B7%B1%E5%85%A5-%E5%85%83%E7%BC%96%E7%A8%8B%E3%80%81%E5%B9%B6%E5%8F%91%E6%8E%A7%E5%88%B6%E3%80%81%E8%BF%90%E8%A1%8C%E6%97%B6%E6%93%8D%E4%BD%9C%E3%80%81%E8%87%AA%E5%8A%A8%E5%BE%AE%E5%88%86%EF%BC%88Automatic-Differentiation%EF%BC%89%E3%80%81Swift-Macro%EF%BC%88%E5%AE%8F%EF%BC%89-%E8%BF%99%E4%BA%9B%E9%AB%98%E7%BA%A7%E6%A6%82%E5%BF%B5%E3%80%82%F0%9F%9A%80"><span class="nav-text">é‚£ä»Šå¤©æˆ‘ä»¬æ·±å…¥ å…ƒç¼–ç¨‹ã€å¹¶å‘æ§åˆ¶ã€è¿è¡Œæ—¶æ“ä½œã€è‡ªåŠ¨å¾®åˆ†ï¼ˆAutomatic Differentiationï¼‰ã€Swift Macroï¼ˆå®ï¼‰ è¿™äº›é«˜çº§æ¦‚å¿µã€‚ğŸš€</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%A4%BA%E4%BE%8B-1-%E4%BD%BF%E7%94%A8-Macro%EF%BC%88Swift-5-9-%EF%BC%89%E8%BF%9B%E8%A1%8C%E4%BB%A3%E7%A0%81%E7%94%9F%E6%88%90"><span class="nav-text">ç¤ºä¾‹ 1: ä½¿ç”¨ Macroï¼ˆSwift 5.9+ï¼‰è¿›è¡Œä»£ç ç”Ÿæˆ</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%A4%BA%E4%BE%8B-2-Swift-%E8%BF%90%E8%A1%8C%E6%97%B6%E5%8A%A8%E6%80%81%E6%96%B9%E6%B3%95%E8%B0%83%E7%94%A8%EF%BC%88%E4%BD%BF%E7%94%A8-NSClassFromString-%E5%92%8C-Selector%EF%BC%89"><span class="nav-text">ç¤ºä¾‹ 2: Swift è¿è¡Œæ—¶åŠ¨æ€æ–¹æ³•è°ƒç”¨ï¼ˆä½¿ç”¨ NSClassFromString å’Œ Selectorï¼‰</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%A4%BA%E4%BE%8B-3-%E4%BD%BF%E7%94%A8-async-let-%E5%AE%9E%E7%8E%B0%E8%B6%85%E9%AB%98%E6%95%88%E5%B9%B6%E5%8F%91%E8%AE%A1%E7%AE%97"><span class="nav-text">ç¤ºä¾‹ 3: ä½¿ç”¨ async let å®ç°è¶…é«˜æ•ˆå¹¶å‘è®¡ç®—</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%A4%BA%E4%BE%8B-4-%E4%BD%BF%E7%94%A8-Automatic-Differentiation%EF%BC%88%E8%87%AA%E5%8A%A8%E5%BE%AE%E5%88%86%EF%BC%89"><span class="nav-text">ç¤ºä¾‹ 4: ä½¿ç”¨ Automatic Differentiationï¼ˆè‡ªåŠ¨å¾®åˆ†ï¼‰</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%A4%BA%E4%BE%8B-5-%E4%BD%BF%E7%94%A8-UnsafeRawPointer-%E7%9B%B4%E6%8E%A5%E6%93%8D%E4%BD%9C%E5%86%85%E5%AD%98"><span class="nav-text">ç¤ºä¾‹ 5: ä½¿ç”¨ UnsafeRawPointer ç›´æ¥æ“ä½œå†…å­˜</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%A4%BA%E4%BE%8B-6-%E4%BD%BF%E7%94%A8-Generative-Type-%E5%88%9B%E5%BB%BA%E8%87%AA%E6%89%A9%E5%B1%95%E7%BB%93%E6%9E%84"><span class="nav-text">ç¤ºä¾‹ 6: ä½¿ç”¨ Generative Type åˆ›å»ºè‡ªæ‰©å±•ç»“æ„</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%BB%88%E6%9E%81%E6%8C%91%E6%88%98"><span class="nav-text">ç»ˆææŒ‘æˆ˜</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%9B%B4%E9%9A%BE%E7%9A%84"><span class="nav-text">æ›´éš¾çš„</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%A4%BA%E4%BE%8B-1-%E4%BD%BF%E7%94%A8-LLVM-IR-%E7%9B%B4%E6%8E%A5%E7%94%9F%E6%88%90%E6%9C%BA%E5%99%A8%E7%A0%81%EF%BC%88Swift-%E7%BC%96%E8%AF%91%E5%99%A8%E5%BA%95%E5%B1%82%EF%BC%89"><span class="nav-text">ç¤ºä¾‹ 1: ä½¿ç”¨ LLVM IR ç›´æ¥ç”Ÿæˆæœºå™¨ç ï¼ˆSwift ç¼–è¯‘å™¨åº•å±‚ï¼‰</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%A4%BA%E4%BE%8B-2-Swift-%E8%BF%90%E8%A1%8C%E6%97%B6%EF%BC%88Runtime%EF%BC%89%E5%8A%A8%E6%80%81%E6%9B%BF%E6%8D%A2%E6%96%B9%E6%B3%95"><span class="nav-text">ç¤ºä¾‹ 2: Swift è¿è¡Œæ—¶ï¼ˆRuntimeï¼‰åŠ¨æ€æ›¿æ¢æ–¹æ³•</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%A4%BA%E4%BE%8B-3-%E7%94%A8-Swift-%E7%BC%96%E5%86%99-JIT-%E7%BC%96%E8%AF%91%E5%99%A8"><span class="nav-text">ç¤ºä¾‹ 3: ç”¨ Swift ç¼–å†™ JIT ç¼–è¯‘å™¨</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%A4%BA%E4%BE%8B-4-Swift-%E5%88%86%E5%B8%83%E5%BC%8F%E8%AE%A1%E7%AE%97"><span class="nav-text">ç¤ºä¾‹ 4: Swift åˆ†å¸ƒå¼è®¡ç®—</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%A4%BA%E4%BE%8B-5-%E4%BD%BF%E7%94%A8-Metal-%E8%BF%9B%E8%A1%8C%E5%BC%82%E6%9E%84%E8%AE%A1%E7%AE%97%EF%BC%88GPU-%E5%8A%A0%E9%80%9F%EF%BC%89"><span class="nav-text">ç¤ºä¾‹ 5: ä½¿ç”¨ Metal è¿›è¡Œå¼‚æ„è®¡ç®—ï¼ˆGPU åŠ é€Ÿï¼‰</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%A4%BA%E4%BE%8B-6-Self-Modifying-Code%EF%BC%88%E4%BB%A3%E7%A0%81%E8%87%AA%E6%88%91%E4%BF%AE%E6%94%B9%EF%BC%89"><span class="nav-text">ç¤ºä¾‹ 6: Self-Modifying Codeï¼ˆä»£ç è‡ªæˆ‘ä¿®æ”¹ï¼‰</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%BB%88%E6%9E%81%E6%8C%91%E6%88%98-1"><span class="nav-text">ç»ˆææŒ‘æˆ˜</span></a></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">YiDa</p>
  <div class="site-description" itemprop="description">è‡ªå¤äººç”Ÿäºä¸–ï¼Œé¡»æœ‰ä¸€æŠ€ä¹‹èƒ½ï¼›æˆ‘è¾ˆæ—¢åŠ¡æ–¯ä¸šï¼Œä¾¿å½“ä¸“å¿ƒç”¨åŠŸï¼›ä»¥ååæ‰¬å››æµ·ï¼Œæ ¹æ®å³åœ¨å¹´è½»ã€‚</div>
</div>
  <div class="cc-license motion-element" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" rel="noopener" target="_blank"><img src="/images/cc-by-nc-sa.svg" alt="Creative Commons"></a>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 2023 â€“ 
  <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">YiDa</span>
</div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="æ€»è®¿å®¢é‡">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="æ€»è®¿é—®é‡">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>

<script src="/js/utils.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  

</body>
</html>
